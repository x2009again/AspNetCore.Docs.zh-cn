<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>IdentityASP.NET Core &#39033;&#30446;&#20013;&#30340;&#22522;&#26550; </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="IdentityASP.NET Core &#39033;&#30446;&#20013;&#30340;&#22522;&#26550; ">
    <meta name="generator" content="docfx 2.56.4.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="/foo">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="security/authentication/scaffold-identity">
<h1 id="scaffold-no-locidentity-in-aspnet-core-projects">IdentityASP.NET Core 项目中的基架</h1>

<p>作者：<a href="https://twitter.com/RickAndMSFT">Rick Anderson</a></p>
<div range="&gt;= aspnetcore-3.0">
<p>ASP.NET Core 提供 <a class="xref" href="identity.html">ASP.NET Core Identity</a> 为类库<a class="xref" href="../../razor-pages/ui-class.html"> Razor </a>。 包含的应用程序 Identity 可以应用 scaffolder 将类库中包含的源代码选择性地添加 Identity Razor (RCL) 。 建议生成源代码，以便修改代码和更改行为。 例如，可以指示基架生成在注册过程中使用的代码。 生成的代码优先于 Identity RCL 中的相同代码。 若要完全控制 UI，而不使用默认的 RCL，请参阅 <a href="#full">创建完整 Identity UI 源</a>部分。</p>
<p><strong>不</strong> 包含身份验证的应用程序可以应用 scaffolder 来添加 RCL Identity 包。 可以选择要生成的 Identity 代码。</p>
<p>尽管 scaffolder 生成了大部分必要的代码，但你需要更新项目以完成该过程。 本文档介绍完成基架更新所需的步骤 Identity 。</p>
<p>建议使用显示文件差异的源代码管理系统，并使您能够回退更改。 运行 scaffolder 后检查更改 Identity 。</p>
<p>使用 <a class="xref" href="identity-enable-qrcodes.html">双重身份验证</a>、 <a class="xref" href="accconfirm.html">帐户确认和密码恢复</a>和其他安全功能时，需要提供服务 Identity 。 基架时不生成服务或服务存根 Identity 。 要启用这些功能，必须手动添加服务。 例如，请参阅 <a class="xref" href="accconfirm.html#require-email-confirmation">需要确认电子邮件</a>。</p>
<p>当 Identity 使用现有个人帐户将具有新数据上下文的基架插入到项目中时：</p>
<ul>
<li>在中 <code>Startup.ConfigureServices</code> ，删除对的调用：
<ul>
<li><code>AddDbContext</code></li>
<li><code>AddDefaultIdentity</code></li>
</ul>
</li>
</ul>
<p>例如， <code>AddDbContext</code> <code>AddDefaultIdentity</code> 在以下代码中注释掉和：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>前面的代码注释了 <em>区域/ Identity / Identity HostingStartup.cs</em> 中的重复代码。</p>
<p>通常，使用个人帐户创建的应用应 * <strong>not</strong> _ 创建新的数据上下文。</p>
<h2 id="scaffold-no-locidentity-into-an-empty-project">基架 Identity 到空项目</h2>
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong>  &gt;  <strong>新的基架项</strong>&quot;。</li>
<li>从 &quot;<strong>添加新的基架项</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot;  &gt;  <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，或将用错误的标记覆盖布局文件：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于 Razor Pages</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于 MVC 项目</li>
<li><code>blazorserver</code>默认情况下，不会为 Razor Pages 或 MVC 为 Blazor 服务器模板（）中创建的 Blazor 服务器应用配置。 将 &quot;布局页&quot; 项留空。</li>
</ul>
</li>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
</ul>
</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将所需的 NuGet 包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>如果出现基架错误，请验证目标框架名字对象 (TFM) 是否与项目文件中的 NuGet 包版本相匹配。 例如，以下项目文件包含适用于 .NET Core 的版本 3.1 和所列的 NuGet 包：</p>
<pre><code class="lang-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Web&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp3.1&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.UI&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Design&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Tools&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.VisualStudio.Web.CodeGeneration.Design&quot; Version=&quot;3.1.0&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>

<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity --useDefaultUI
</code></pre>
</section>
</div>

<p><code>Startup</code>用类似于下面的代码更新类：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><p><code>UseHsts</code>建议，但不是必需的。 有关详细信息，请参阅<a class="xref" href="../enforcing-ssl.html#http-strict-transport-security-protocol-hsts">HTTP 严格传输安全协议</a>。</p>
<p>生成的标识数据库代码需要<a href="/ef/core/managing-schemas/migrations/">Entity Framework Core 迁移</a>。 创建迁移并更新数据库。 例如，运行以下命令：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>在 Visual Studio<strong>包管理器控制台</strong>中：</p>
<pre><code class="lang-powershell">Install-Package Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore
Add-Migration CreateIdentitySchema
Update-Database
</code></pre>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<pre><code class="lang-dotnetcli">dotnet ef migrations add CreateIdentitySchema
dotnet ef database update
</code></pre>
</section>
</div>

<p><code>Add-Migration</code> 命令的 &quot;CreateIdentitySchema&quot; name 参数是任意的。 <code>&quot;CreateIdentitySchema&quot;</code> 介绍迁移。</p>
<h2 id="scaffold-no-locidentity-into-a-no-locrazor-project-without-existing-authorization">基架 Identity 到 Razor 无现有授权的项目</h2>
<!--  Updated for 3.0
set projNam=RPnoAuth
set projType=webapp

dotnet new %projType% -o %projNam%
cd %projNam%
dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
dotnet aspnet-codegenerator identity --useDefaultUI
dotnet ef database drop
dotnet ef migrations add CreateIdentitySchema0
dotnet ef database update
-->
<!-- ERROR
There is already an object named 'AspNetRoles' in the database.

Fixed via dotnet ef database drop
before dotnet ef database update
-->
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong>  &gt;  <strong>新的基架项</strong>&quot;。</li>
<li>从 &quot;<strong>添加新的基架项</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot;  &gt;  <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，或将用错误的标记覆盖布局文件：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于 Razor Pages</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于 MVC 项目</li>
<li><code>blazorserver</code>默认情况下，不会为 Razor Pages 或 MVC 为 Blazor 服务器模板（）中创建的 Blazor 服务器应用配置。 将 &quot;布局页&quot; 项留空。</li>
</ul>
</li>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
</ul>
</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将所需的 NuGet 包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>如果出现基架错误，请验证目标框架名字对象 (TFM) 是否与项目文件中的 NuGet 包版本相匹配。 例如，以下项目文件包含适用于 .NET Core 的版本 3.1 和所列的 NuGet 包：</p>
<pre><code class="lang-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Web&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp3.1&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.UI&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Design&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Tools&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.VisualStudio.Web.CodeGeneration.Design&quot; Version=&quot;3.1.0&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>

<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity --useDefaultUI
</code></pre>
</section>
</div>

<p>Identity在 _Areas/HostingStartup.cs * 中进行配置 Identity / Identity 。 有关详细信息，请参阅 <a class="xref" href="../../fundamentals/host/platform-specific-configuration.html">IHostingStartup</a>。</p>
<p><a name="efm"></a></p>
<h3 id="migrations-useauthentication-and-layout">迁移、UseAuthentication 和布局</h3>
<p>生成的标识数据库代码需要<a href="/ef/core/managing-schemas/migrations/">Entity Framework Core 迁移</a>。 创建迁移并更新数据库。 例如，运行以下命令：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>在 Visual Studio<strong>包管理器控制台</strong>中：</p>
<pre><code class="lang-powershell">Install-Package Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore
Add-Migration CreateIdentitySchema
Update-Database
</code></pre>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<pre><code class="lang-dotnetcli">dotnet ef migrations add CreateIdentitySchema
dotnet ef database update
</code></pre>
</section>
</div>

<p><code>Add-Migration</code> 命令的 &quot;CreateIdentitySchema&quot; name 参数是任意的。 <code>&quot;CreateIdentitySchema&quot;</code> 介绍迁移。</p>

<p><a name="useauthentication"></a></p>
<h3 id="enable-authentication">启用身份验证</h3>
<p><code>Startup</code>用类似于下面的代码更新类：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><p><code>UseHsts</code>建议，但不是必需的。 有关详细信息，请参阅<a class="xref" href="../enforcing-ssl.html#http-strict-transport-security-protocol-hsts">HTTP 严格传输安全协议</a>。</p>
<h3 id="layout-changes">布局更改</h3>
<p>可选：将登录部分 (<code>_LoginPartial</code>) 添加到布局文件中：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><h2 id="scaffold-no-locidentity-into-a-no-locrazor-project-with-authorization">Identity Razor 使用授权基架到项目中</h2>
<!--
Use >=2.1: dotnet new webapp -au Individual -o RPauth
Use = 2.0: dotnet new razor -au Individual -o RPauth
uld option: Use Local DB, not SQLite

dotnet new webapp -au Individual -uld -o RPauth
cd RPauth
dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet aspnet-codegenerator identity -dc RPauth.Data.ApplicationDbContext --files "Account.Register;Account.Register"
-->
<div range="&gt;= aspnetcore-3.0">
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong> &gt; <strong>新的基架项</strong>&quot;。</li>
<li>在 &quot;<strong>添加基架</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot; &gt; <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，以便不会用错误的标记覆盖布局文件。 如果选择了现有的* _ 布局 cshtml*文件，则<strong>不</strong>会覆盖它。 例如：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于包含现有 Razor Pages 基础结构 Razor Pages 或 Blazor 服务器项目</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于包含现有 MVC 基础结构的 MVC 项目或 Blazor 服务器项目</li>
</ul>
</li>
</ul>
</li>
<li>若要使用现有的数据上下文，请至少选择一个要重写的文件。 必须至少选择一个文件以添加数据上下文。
<ul>
<li>选择数据上下文类。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
<li>创建新的用户上下文，并可能为标识创建自定义用户类：
<ul>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
</ul>
<p>注意：如果要创建新的用户上下文，则无需选择要重写的文件。</p>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将所需的 NuGet 包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>如果出现基架错误，请验证目标框架名字对象 (TFM) 是否与项目文件中的 NuGet 包版本相匹配。 例如，以下项目文件包含适用于 .NET Core 的版本 3.1 和所列的 NuGet 包：</p>
<pre><code class="lang-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Web&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp3.1&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.UI&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Design&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Tools&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.VisualStudio.Web.CodeGeneration.Design&quot; Version=&quot;3.1.0&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>

<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令。 为数据库上下文使用正确的完全限定名：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login&quot;
</code></pre>
<p>PowerShell 使用分号作为命令分隔符。 使用 PowerShell 时，请在文件列表中转义分号，或将文件列表置于双引号中。 例如：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login;Account.Logout&quot;
</code></pre>
<p>如果在未指定标志或标志的情况下运行标识 scaffolder <code>--files</code> <code>--useDefaultUI</code> ，则会在项目中创建所有可用的标识 UI 页。</p>
</section>
</div>
</div>
<div range="&lt; aspnetcore-3.0">
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q-1_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong> &gt; <strong>新的基架项</strong>&quot;。</li>
<li>在 &quot;<strong>添加基架</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot; &gt; <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，否则将用错误的标记覆盖你的布局文件。 如果选择了现有的* _ 布局 cshtml*文件，则<strong>不</strong>会覆盖它。 例如：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于 Razor Pages</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于 MVC 项目</li>
</ul>
</li>
</ul>
</li>
<li>若要使用现有的数据上下文，请至少选择一个要重写的文件。 必须至少选择一个文件以添加数据上下文。
<ul>
<li>选择数据上下文类。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
<li>创建新的用户上下文，并可能为标识创建自定义用户类：
<ul>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
</ul>
<p>注意：如果要创建新的用户上下文，则无需选择要重写的文件。</p>
</section>
<section id="tabpanel_CeZOj-G++Q-1_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将对<a href="https://www.nuget.org/packages/Microsoft.VisualStudio.Web.CodeGeneration.Design/">VisualStudio</a>的包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet restore
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令。 为数据库上下文使用正确的完全限定名：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login&quot;
</code></pre>
<p>PowerShell 使用分号作为命令分隔符。 使用 PowerShell 时，请在文件列表中转义分号，或将文件列表置于双引号中。 例如：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login;Account.Logout&quot;
</code></pre>
<p>如果在未指定标志或标志的情况下运行标识 scaffolder <code>--files</code> <code>--useDefaultUI</code> ，则会在项目中创建所有可用的标识 UI 页。</p>
</section>
</div>
</div>

<p>某些 Identity 选项在 <em>区域/ Identity / Identity HostingStartup.cs</em> 中配置。 有关详细信息，请参阅 <a class="xref" href="../../fundamentals/host/platform-specific-configuration.html">IHostingStartup</a>。</p>
<h2 id="scaffold-no-locidentity-into-an-mvc-project-without-existing-authorization">基架 Identity 到没有现有授权的 MVC 项目</h2>
<!--
set projNam=MvcNoAuth
set projType=mvc
set version=2.1.0

dotnet new %projType% -o %projNam%
cd %projNam%
dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design -v %version%
dotnet restore
dotnet aspnet-codegenerator identity --useDefaultUI
dotnet ef migrations add CreateIdentitySchema
dotnet ef database update
-->
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong>  &gt;  <strong>新的基架项</strong>&quot;。</li>
<li>从 &quot;<strong>添加新的基架项</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot;  &gt;  <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，或将用错误的标记覆盖布局文件：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于 Razor Pages</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于 MVC 项目</li>
<li><code>blazorserver</code>默认情况下，不会为 Razor Pages 或 MVC 为 Blazor 服务器模板（）中创建的 Blazor 服务器应用配置。 将 &quot;布局页&quot; 项留空。</li>
</ul>
</li>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
</ul>
</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将所需的 NuGet 包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>如果出现基架错误，请验证目标框架名字对象 (TFM) 是否与项目文件中的 NuGet 包版本相匹配。 例如，以下项目文件包含适用于 .NET Core 的版本 3.1 和所列的 NuGet 包：</p>
<pre><code class="lang-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Web&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp3.1&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.UI&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Design&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Tools&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.VisualStudio.Web.CodeGeneration.Design&quot; Version=&quot;3.1.0&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>

<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity --useDefaultUI
</code></pre>
</section>
</div>

<p>可选：将登录名部分 (<code>_LoginPartial</code>) 添加到 <em>Views/Shared/_Layout</em> 文件中：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<ul>
<li>将 <em>Pages/shared/_LoginPartial cshtml</em> 文件移动到 <em>Views/shared/_LoginPartial。 cshtml</em></li>
</ul>
<p>Identity在 <em>区域/ Identity / Identity HostingStartup.cs</em> 中配置。 有关详细信息，请参阅 IHostingStartup。</p>
<p>生成的标识数据库代码需要<a href="/ef/core/managing-schemas/migrations/">Entity Framework Core 迁移</a>。 创建迁移并更新数据库。 例如，运行以下命令：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>在 Visual Studio<strong>包管理器控制台</strong>中：</p>
<pre><code class="lang-powershell">Install-Package Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore
Add-Migration CreateIdentitySchema
Update-Database
</code></pre>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<pre><code class="lang-dotnetcli">dotnet ef migrations add CreateIdentitySchema
dotnet ef database update
</code></pre>
</section>
</div>

<p><code>Add-Migration</code> 命令的 &quot;CreateIdentitySchema&quot; name 参数是任意的。 <code>&quot;CreateIdentitySchema&quot;</code> 介绍迁移。</p>

<p><code>Startup</code>用类似于下面的代码更新类：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><p><code>UseHsts</code>建议，但不是必需的。 有关详细信息，请参阅<a class="xref" href="../enforcing-ssl.html#http-strict-transport-security-protocol-hsts">HTTP 严格传输安全协议</a>。</p>
<h2 id="scaffold-no-locidentity-into-an-mvc-project-with-authorization">Identity使用授权基架到 MVC 项目</h2>
<!--
dotnet new mvc -au Individual -o MvcAuth
cd MvcAuth
dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet restore
dotnet aspnet-codegenerator identity -dc MvcAuth.Data.ApplicationDbContext  --files "Account.Login;Account.Register"
-->
<div range="&gt;= aspnetcore-3.0">
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong> &gt; <strong>新的基架项</strong>&quot;。</li>
<li>在 &quot;<strong>添加基架</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot; &gt; <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，以便不会用错误的标记覆盖布局文件。 如果选择了现有的* _ 布局 cshtml*文件，则<strong>不</strong>会覆盖它。 例如：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于包含现有 Razor Pages 基础结构 Razor Pages 或 Blazor 服务器项目</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于包含现有 MVC 基础结构的 MVC 项目或 Blazor 服务器项目</li>
</ul>
</li>
</ul>
</li>
<li>若要使用现有的数据上下文，请至少选择一个要重写的文件。 必须至少选择一个文件以添加数据上下文。
<ul>
<li>选择数据上下文类。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
<li>创建新的用户上下文，并可能为标识创建自定义用户类：
<ul>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
</ul>
<p>注意：如果要创建新的用户上下文，则无需选择要重写的文件。</p>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将所需的 NuGet 包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>如果出现基架错误，请验证目标框架名字对象 (TFM) 是否与项目文件中的 NuGet 包版本相匹配。 例如，以下项目文件包含适用于 .NET Core 的版本 3.1 和所列的 NuGet 包：</p>
<pre><code class="lang-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Web&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp3.1&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.UI&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Design&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Tools&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.VisualStudio.Web.CodeGeneration.Design&quot; Version=&quot;3.1.0&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>

<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令。 为数据库上下文使用正确的完全限定名：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login&quot;
</code></pre>
<p>PowerShell 使用分号作为命令分隔符。 使用 PowerShell 时，请在文件列表中转义分号，或将文件列表置于双引号中。 例如：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login;Account.Logout&quot;
</code></pre>
<p>如果在未指定标志或标志的情况下运行标识 scaffolder <code>--files</code> <code>--useDefaultUI</code> ，则会在项目中创建所有可用的标识 UI 页。</p>
</section>
</div>
</div>
<div range="&lt; aspnetcore-3.0">
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q-1_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong> &gt; <strong>新的基架项</strong>&quot;。</li>
<li>在 &quot;<strong>添加基架</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot; &gt; <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，否则将用错误的标记覆盖你的布局文件。 如果选择了现有的* _ 布局 cshtml*文件，则<strong>不</strong>会覆盖它。 例如：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于 Razor Pages</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于 MVC 项目</li>
</ul>
</li>
</ul>
</li>
<li>若要使用现有的数据上下文，请至少选择一个要重写的文件。 必须至少选择一个文件以添加数据上下文。
<ul>
<li>选择数据上下文类。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
<li>创建新的用户上下文，并可能为标识创建自定义用户类：
<ul>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
</ul>
<p>注意：如果要创建新的用户上下文，则无需选择要重写的文件。</p>
</section>
<section id="tabpanel_CeZOj-G++Q-1_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将对<a href="https://www.nuget.org/packages/Microsoft.VisualStudio.Web.CodeGeneration.Design/">VisualStudio</a>的包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet restore
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令。 为数据库上下文使用正确的完全限定名：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login&quot;
</code></pre>
<p>PowerShell 使用分号作为命令分隔符。 使用 PowerShell 时，请在文件列表中转义分号，或将文件列表置于双引号中。 例如：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login;Account.Logout&quot;
</code></pre>
<p>如果在未指定标志或标志的情况下运行标识 scaffolder <code>--files</code> <code>--useDefaultUI</code> ，则会在项目中创建所有可用的标识 UI 页。</p>
</section>
</div>
</div>
<h2 id="scaffold-no-locidentity-into-a-no-locblazor-server-project-without-existing-authorization">基架 Identity 到 Blazor Server 无现有授权的项目</h2>
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong>  &gt;  <strong>新的基架项</strong>&quot;。</li>
<li>从 &quot;<strong>添加新的基架项</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot;  &gt;  <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，或将用错误的标记覆盖布局文件：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于 Razor Pages</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于 MVC 项目</li>
<li><code>blazorserver</code>默认情况下，不会为 Razor Pages 或 MVC 为 Blazor 服务器模板（）中创建的 Blazor 服务器应用配置。 将 &quot;布局页&quot; 项留空。</li>
</ul>
</li>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
</ul>
</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将所需的 NuGet 包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>如果出现基架错误，请验证目标框架名字对象 (TFM) 是否与项目文件中的 NuGet 包版本相匹配。 例如，以下项目文件包含适用于 .NET Core 的版本 3.1 和所列的 NuGet 包：</p>
<pre><code class="lang-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Web&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp3.1&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.UI&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Design&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Tools&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.VisualStudio.Web.CodeGeneration.Design&quot; Version=&quot;3.1.0&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>

<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity --useDefaultUI
</code></pre>
</section>
</div>

<p>Identity在 <em>区域/ Identity / Identity HostingStartup.cs</em> 中配置。 有关详细信息，请参阅 <a class="xref" href="../../fundamentals/host/platform-specific-configuration.html">IHostingStartup</a>。</p>
<h3 id="migrations">迁移</h3>
<p>生成的标识数据库代码需要<a href="/ef/core/managing-schemas/migrations/">Entity Framework Core 迁移</a>。 创建迁移并更新数据库。 例如，运行以下命令：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>在 Visual Studio<strong>包管理器控制台</strong>中：</p>
<pre><code class="lang-powershell">Install-Package Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore
Add-Migration CreateIdentitySchema
Update-Database
</code></pre>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<pre><code class="lang-dotnetcli">dotnet ef migrations add CreateIdentitySchema
dotnet ef database update
</code></pre>
</section>
</div>

<p><code>Add-Migration</code> 命令的 &quot;CreateIdentitySchema&quot; name 参数是任意的。 <code>&quot;CreateIdentitySchema&quot;</code> 介绍迁移。</p>
<h3 id="pass-an-xsrf-token-to-the-app">将 XSRF 令牌传递给应用</h3>
<p>可以将令牌传递给组件：</p>
<ul>
<li>设置身份验证令牌并将其保存到身份验证后 cookie ，可以将其传递给组件。</li>
<li>Razor 组件不能 <code>HttpContext</code> 直接使用，因此无法获取 <a class="xref" href="../anti-request-forgery.html"> (XSRF 的) 令牌的反请求伪造</a> Identity <code>/Identity/Account/Logout</code> 。 可以将 XSRF 令牌传递给组件。</li>
</ul>
<p>有关详细信息，请参阅 <a class="xref" href="../../blazor/security/server/additional-scenarios.html#pass-tokens-to-a-blazor-server-app">ASP.NET Core Blazor Server 其他安全方案</a>。</p>
<p>在 <em>Pages/_Host cshtml</em> 文件中，在将其添加到和类后建立该令牌 <code>InitialApplicationState</code> <code>TokenProvider</code> ：</p>
<pre><code class="lang-csharp">@inject Microsoft.AspNetCore.Antiforgery.IAntiforgery Xsrf

...

var tokens = new InitialApplicationState
{
    ...

    XsrfToken = Xsrf.GetAndStoreTokens(HttpContext).RequestToken
};
</code></pre>
<p><code>App</code>将组件更新 ( <em>App.razor</em> ) ，以分配 <code>InitialState.XsrfToken</code> ：</p>
<pre><code class="lang-csharp">@inject TokenProvider TokenProvider

...

TokenProvider.XsrfToken = InitialState.XsrfToken;
</code></pre>
<p>本 <code>TokenProvider</code> 主题中演示的服务在 <code>LoginDisplay</code> 以下 <a href="#layout-and-authentication-flow-changes">布局和身份验证流更改</a> 部分的组件中使用。</p>
<h3 id="enable-authentication">启用身份验证</h3>
<p>在 <code>Startup</code> 类中：</p>
<ul>
<li>确认 Razor 在中添加了页面服务 <code>Startup.ConfigureServices</code> 。</li>
<li>如果使用 <a class="xref" href="../../blazor/security/server/additional-scenarios.html#pass-tokens-to-a-blazor-server-app">TokenProvider</a>，请注册服务。</li>
<li><code>UseDatabaseErrorPage</code>对于开发环境，请在中的应用程序生成器上调用 <code>Startup.Configure</code> 。</li>
<li>调用 <code>UseAuthentication</code> and <code>UseAuthorization</code> after <code>UseRouting</code> 。</li>
<li>添加页的终结点 Razor 。</li>
</ul>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><p><code>UseHsts</code>建议，但不是必需的。 有关详细信息，请参阅<a class="xref" href="../enforcing-ssl.html#http-strict-transport-security-protocol-hsts">HTTP 严格传输安全协议</a>。</p>
<h3 id="layout-and-authentication-flow-changes">布局和身份验证流更改</h3>
<p>将 <code>RedirectToLogin</code> <em>RedirectToLogin</em> ) 的 (组件添加到项目根目录中应用的 <em>共享</em> 文件夹中：</p>
<pre><code class="lang-razor">@inject NavigationManager Navigation
@code {
    protected override void OnInitialized()
    {
        Navigation.NavigateTo(&quot;Identity/Account/Login?returnUrl=&quot; +
            Uri.EscapeDataString(Navigation.Uri), true);
    }
}
</code></pre>
<p>将 <code>LoginDisplay</code> () 的 <em>LoginDisplay.razor</em> 组件添加到应用的 <em>共享</em> 文件夹。 <a class="xref" href="../../blazor/security/server/additional-scenarios.html#pass-tokens-to-a-blazor-server-app">TokenProvider 服务</a>提供 HTML 窗体的 XSRF 标记，该标记将发布到 Identity 注销终结点：</p>
<pre><code class="lang-razor">@using Microsoft.AspNetCore.Components.Authorization
@inject NavigationManager Navigation
@inject TokenProvider TokenProvider

&lt;AuthorizeView&gt;
    &lt;Authorized&gt;
        &lt;a href=&quot;Identity/Account/Manage/Index&quot;&gt;
            Hello, @context.User.Identity.Name!
        &lt;/a&gt;
        &lt;form action=&quot;/Identity/Account/Logout?returnUrl=%2F&quot; method=&quot;post&quot;&gt;
            &lt;button class=&quot;nav-link btn btn-link&quot; type=&quot;submit&quot;&gt;Logout&lt;/button&gt;
            &lt;input name=&quot;__RequestVerificationToken&quot; type=&quot;hidden&quot; 
                value=&quot;@TokenProvider.XsrfToken&quot;&gt;
        &lt;/form&gt;
    &lt;/Authorized&gt;
    &lt;NotAuthorized&gt;
        &lt;a href=&quot;Identity/Account/Register&quot;&gt;Register&lt;/a&gt;
        &lt;a href=&quot;Identity/Account/Login&quot;&gt;Login&lt;/a&gt;
    &lt;/NotAuthorized&gt;
&lt;/AuthorizeView&gt;
</code></pre>
<p>在 <code>MainLayout</code> ( <em>Shared/MainLayout</em> ) 的组件中，将组件添加 <code>LoginDisplay</code> 到顶层行 <code>&lt;div&gt;</code> 元素的内容：</p>
<pre><code class="lang-razor">&lt;div class=&quot;top-row px-4 auth&quot;&gt;
    &lt;LoginDisplay /&gt;
    &lt;a href=&quot;https://docs.microsoft.com/aspnet/&quot; target=&quot;_blank&quot;&gt;About&lt;/a&gt;
&lt;/div&gt;
</code></pre>
<h3 id="style-authentication-endpoints">样式身份验证终结点</h3>
<p>由于 Blazor Server 使用 Razor 页面 Identity 页，当访问者在页面和组件间导航时，UI 的样式会发生变化 Identity 。 可以使用两个选项来处理 incongruous 样式：</p>
<h4 id="build-no-locidentity-components">生成 Identity 组件</h4>
<p>使用而不是页的组件的方法 Identity 是生成 Identity 组件。 由于 <code>SignInManager</code> <code>UserManager</code> 在组件中不支持和 Razor ，因此在应用程序中使用 API 终结点 Blazor Server 来处理用户帐户操作。</p>
<h4 id="use-a-custom-layout-with-no-locblazor-app-styles">在应用程序样式中使用自定义布局 Blazor</h4>
<p>Identity可以修改页面布局和样式，以生成使用默认主题的页面 Blazor 。</p>
<div class="NOTE">
<h5>Note</h5>
<p>本节中的示例只是一个自定义的起点。 为了获得最佳用户体验，可能需要额外的工作。</p>
</div>
<p><code>NavMenu_IdentityLayout</code> ( <em>Shared/NavMenu_ Identity Layout</em> ) 创建新的组件。 对于组件的标记和代码，请 <code>NavMenu</code> ( <em>Shared/NavMenu</em> ) 使用应用组件的相同内容。 去除 <code>NavLink</code> 无法匿名访问的组件，因为组件中的自动重定向 <code>RedirectToLogin</code> 对于需要身份验证或授权的组件失败。</p>
<p>在 <em>Pages/Shared/Layout</em> 文件中，进行以下更改：</p>
<ul>
<li><p>将 Razor 指令添加到文件顶部，以使用 <em>共享</em> 文件夹中的标记帮助程序和应用组件：</p>
<pre><code class="lang-cshtml">@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@using {APPLICATION ASSEMBLY}.Shared
</code></pre>
<p>替换 <code>{APPLICATION ASSEMBLY}</code> 为应用程序的程序集名称。</p>
</li>
<li><p>向 <code>&lt;base&gt;</code> 内容添加标记和 Blazor 样式 <code>&lt;link&gt;</code> 表 <code>&lt;head&gt;</code> ：</p>
<pre><code class="lang-cshtml">&lt;base href=&quot;~/&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;~/css/site.css&quot; /&gt;
</code></pre>
</li>
<li><p>将标记的内容更改 <code>&lt;body&gt;</code> 为以下内容：</p>
<pre><code class="lang-cshtml">&lt;div class=&quot;sidebar&quot; style=&quot;float:left&quot;&gt;
    &lt;component type=&quot;typeof(NavMenu_IdentityLayout)&quot; 
        render-mode=&quot;ServerPrerendered&quot; /&gt;
&lt;/div&gt;

&lt;div class=&quot;main&quot; style=&quot;padding-left:250px&quot;&gt;
    &lt;div class=&quot;top-row px-4&quot;&gt;
        @{
            var result = Engine.FindView(ViewContext, &quot;_LoginPartial&quot;, 
                isMainPage: false);
        }
        @if (result.Success)
        {
            await Html.RenderPartialAsync(&quot;_LoginPartial&quot;);
        }
        else
        {
            throw new InvalidOperationException(&quot;The default Identity UI &quot; +
                &quot;layout requires a partial view '_LoginPartial'.&quot;);
        }
        &lt;a href=&quot;https://docs.microsoft.com/aspnet/&quot; target=&quot;_blank&quot;&gt;About&lt;/a&gt;
    &lt;/div&gt;

    &lt;div class=&quot;content px-4&quot;&gt;
        @RenderBody()
    &lt;/div&gt;
&lt;/div&gt;

&lt;script src=&quot;~/Identity/lib/jquery/dist/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;~/Identity/lib/bootstrap/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;~/Identity/js/site.js&quot; asp-append-version=&quot;true&quot;&gt;&lt;/script&gt;
@RenderSection(&quot;Scripts&quot;, required: false)
&lt;script src=&quot;_framework/blazor.server.js&quot;&gt;&lt;/script&gt;
</code></pre>
</li>
</ul>
<h2 id="scaffold-no-locidentity-into-a-no-locblazor-server-project-with-authorization">Identity Blazor Server 使用授权基架到项目中</h2>
<div range="&gt;= aspnetcore-3.0">
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong> &gt; <strong>新的基架项</strong>&quot;。</li>
<li>在 &quot;<strong>添加基架</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot; &gt; <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，以便不会用错误的标记覆盖布局文件。 如果选择了现有的* _ 布局 cshtml*文件，则<strong>不</strong>会覆盖它。 例如：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于包含现有 Razor Pages 基础结构 Razor Pages 或 Blazor 服务器项目</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于包含现有 MVC 基础结构的 MVC 项目或 Blazor 服务器项目</li>
</ul>
</li>
</ul>
</li>
<li>若要使用现有的数据上下文，请至少选择一个要重写的文件。 必须至少选择一个文件以添加数据上下文。
<ul>
<li>选择数据上下文类。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
<li>创建新的用户上下文，并可能为标识创建自定义用户类：
<ul>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
</ul>
<p>注意：如果要创建新的用户上下文，则无需选择要重写的文件。</p>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将所需的 NuGet 包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>如果出现基架错误，请验证目标框架名字对象 (TFM) 是否与项目文件中的 NuGet 包版本相匹配。 例如，以下项目文件包含适用于 .NET Core 的版本 3.1 和所列的 NuGet 包：</p>
<pre><code class="lang-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Web&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp3.1&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.UI&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Design&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Tools&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.VisualStudio.Web.CodeGeneration.Design&quot; Version=&quot;3.1.0&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>

<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令。 为数据库上下文使用正确的完全限定名：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login&quot;
</code></pre>
<p>PowerShell 使用分号作为命令分隔符。 使用 PowerShell 时，请在文件列表中转义分号，或将文件列表置于双引号中。 例如：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login;Account.Logout&quot;
</code></pre>
<p>如果在未指定标志或标志的情况下运行标识 scaffolder <code>--files</code> <code>--useDefaultUI</code> ，则会在项目中创建所有可用的标识 UI 页。</p>
</section>
</div>
</div>
<div range="&lt; aspnetcore-3.0">
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q-1_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong> &gt; <strong>新的基架项</strong>&quot;。</li>
<li>在 &quot;<strong>添加基架</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot; &gt; <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，否则将用错误的标记覆盖你的布局文件。 如果选择了现有的* _ 布局 cshtml*文件，则<strong>不</strong>会覆盖它。 例如：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于 Razor Pages</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于 MVC 项目</li>
</ul>
</li>
</ul>
</li>
<li>若要使用现有的数据上下文，请至少选择一个要重写的文件。 必须至少选择一个文件以添加数据上下文。
<ul>
<li>选择数据上下文类。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
<li>创建新的用户上下文，并可能为标识创建自定义用户类：
<ul>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
</ul>
<p>注意：如果要创建新的用户上下文，则无需选择要重写的文件。</p>
</section>
<section id="tabpanel_CeZOj-G++Q-1_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将对<a href="https://www.nuget.org/packages/Microsoft.VisualStudio.Web.CodeGeneration.Design/">VisualStudio</a>的包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet restore
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令。 为数据库上下文使用正确的完全限定名：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login&quot;
</code></pre>
<p>PowerShell 使用分号作为命令分隔符。 使用 PowerShell 时，请在文件列表中转义分号，或将文件列表置于双引号中。 例如：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login;Account.Logout&quot;
</code></pre>
<p>如果在未指定标志或标志的情况下运行标识 scaffolder <code>--files</code> <code>--useDefaultUI</code> ，则会在项目中创建所有可用的标识 UI 页。</p>
</section>
</div>
</div>

<p>某些 Identity 选项在 <em>区域/ Identity / Identity HostingStartup.cs</em> 中配置。 有关详细信息，请参阅 <a class="xref" href="../../fundamentals/host/platform-specific-configuration.html">IHostingStartup</a>。</p>
<h2 id="standalone-or-hosted-no-locblazor-webassembly-apps">独立应用或托管 Blazor WebAssembly 应用</h2>
<p>客户端 Blazor WebAssembly 应用使用其自己的 Identity UI 方法，不能使用 ASP.NET Core Identity 基架。 托管解决方案的服务器端 ASP.NET Core 应用 Blazor 可以遵循 Razor 本文中的页面/MVC 指南，并配置为与支持的任何其他类型的 ASP.NET Core 应用一样 Identity 。</p>
<p>此 Blazor 框架不包括 Razor UI 页面的组件版本 Identity 。 Identity UI Razor 组件可以是自定义生成的，也可以从不受支持的第三方源获取。</p>
<p>有关详细信息，请参阅<a class="xref" href="../../blazor/security/index.html"> Blazor 安全性和 Identity 文章</a>。</p>
<p><a name="full"></a></p>
<h2 id="create-full-no-locidentity-ui-source">创建完整的 Identity UI 源</h2>
<p>若要维护 UI 的完全控制 Identity ，请运行 Identity scaffolder 并选择 &quot; <strong>替代所有文件</strong> &quot;。</p>
<p>以下突出显示的代码显示了将默认 UI 替换为 Identity Identity ASP.NET Core 2.1 web 应用中的更改。 你可能希望执行此操作以对 UI 具有完全控制 Identity 。</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>Identity在以下代码中，将替换默认值：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>下面的代码将设置 <a href="/dotnet/api/microsoft.aspnetcore.authentication.cookies.cookieauthenticationoptions.loginpath">LoginPath</a>、 <a href="/dotnet/api/microsoft.aspnetcore.authentication.cookies.cookieauthenticationoptions.logoutpath">LogoutPath</a>和 <a href="/dotnet/api/microsoft.aspnetcore.authentication.cookies.cookieauthenticationoptions.accessdeniedpath">AccessDeniedPath</a>：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>注册 <code>IEmailSender</code> 实现，例如：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><!--
uld option: Use Local DB, not SQLite

dotnet new webapp -au Individual -uld -o RPauth
cd RPauth
dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet aspnet-codegenerator identity -dc RPauth.Data.ApplicationDbContext --files "Account.Register;Account.Login;Account.RegisterConfirmation"
-->
<h2 id="password-configuration">密码配置</h2>
<p>如果 &lt;xref:Microsoft.AspNetCore.Identity.PasswordOptions&gt; 在中配置了 <code>Startup.ConfigureServices</code> ，则基架页中的属性可能需要<a href="xref:System.ComponentModel.DataAnnotations.StringLengthAttribute"> <code>[StringLength]</code> 属性</a>配置 <code>Password</code> Identity 。 <code>InputModel``Password</code>在以下文件中可以找到属性：</p>
<ul>
<li><code>Areas/Identity/Pages/Account/Register.cshtml.cs</code></li>
<li><code>Areas/Identity/Pages/Account/ResetPassword.cshtml.cs</code></li>
</ul>
<h2 id="disable-a-page">禁用页面</h2>
<p>本部分介绍如何禁用注册页面，但该方法可用于禁用任何页面。</p>
<p>禁用用户注册：</p>
<ul>
<li><p>基架 Identity 。 包括帐户. Register、RegisterConfirmation。 例如：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc RPauth.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login;Account.RegisterConfirmation&quot;
</code></pre>
</li>
<li><p>更新 <em>区域/ Identity /Pages/Account/Register.cshtml.cs</em> ，使用户无法从此终结点注册：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div></li>
<li><p>更新 <em>区域/ Identity /Pages/Account/Register.cshtml</em> ，使其与前面的更改一致：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div></li>
<li><p>注释掉或删除 <em>区域/ Identity /Pages/Account/Login.cshtml</em> 中的注册链接</p>
<pre><code class="lang-cshtml">@*
&lt;p&gt;
    &lt;a asp-page=&quot;./Register&quot; asp-route-returnUrl=&quot;@Model.ReturnUrl&quot;&gt;Register as a new user&lt;/a&gt;
&lt;/p&gt;
*@
</code></pre>
</li>
<li><p>更新 &quot; <em>区域/ Identity /Pages/Account/RegisterConfirmation</em> &quot; 页。</p>
<ul>
<li>删除来自 cshtml 文件的代码和链接。</li>
<li>从中删除确认代码 <code>PageModel</code> ：</li>
</ul>
<pre><code class="lang-csharp">[AllowAnonymous]
  public class RegisterConfirmationModel : PageModel
  {
      public IActionResult OnGet()
      {  
          return Page();
      }
  }
</code></pre>
</li>
</ul>
<h3 id="use-another-app-to-add-users">使用其他应用添加用户</h3>
<p>提供一种在 web 应用外部添加用户的机制。 用于添加用户的选项包括：</p>
<ul>
<li>专用的管理 web 应用。</li>
<li>控制台应用。</li>
</ul>
<p>下面的代码概述了一种添加用户的方法：</p>
<ul>
<li>用户列表将读入内存中。</li>
<li>为每个用户生成一个强唯一密码。</li>
<li>用户已添加到 Identity 数据库。</li>
<li>系统会通知用户并通知用户更改密码。</li>
</ul>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>下面的代码概述了如何添加用户：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>对于生产方案，可以遵循类似的方法。</p>
<h2 id="prevent-publish-of-static-no-locidentity-assets">禁止发布静态 Identity 资产</h2>
<p>若要防止 Identity 将静态资产发布到 web 根目录，请参阅 <a class="xref" href="identity.html#prevent-publish-of-static-identity-assets">ASP.NET Core 简介 Identity</a> 。</p>
<h2 id="additional-resources">其他资源</h2>
<ul>
<li><a class="xref" href="../../migration/20_21.html#changes-to-authentication-code">更改为 ASP.NET Core 2.1 及更高版本的身份验证代码</a></li>
</ul>
</div>
<div range="&lt; aspnetcore-3.0">
<p>ASP.NET Core 2.1 和更高版本提供 <a class="xref" href="identity.html">ASP.NET Core Identity</a> 为<a class="xref" href="../../razor-pages/ui-class.html"> Razor 类库</a>。 包含的应用程序 Identity 可以应用 scaffolder 将类库中包含的源代码选择性地添加 Identity Razor (RCL) 。 建议生成源代码，以便修改代码和更改行为。 例如，可以指示基架生成在注册过程中使用的代码。 生成的代码优先于 Identity RCL 中的相同代码。 若要完全控制 UI，而不使用默认的 RCL，请参阅 <a href="#full">创建完全标识 UI 源</a>部分。</p>
<p><strong>不</strong> 包含身份验证的应用程序可以应用 scaffolder 来添加 RCL Identity 包。 可以选择要生成的 Identity 代码。</p>
<p>尽管 scaffolder 生成了大部分必要的代码，但你必须更新项目才能完成此过程。 本文档介绍完成基架更新所需的步骤 Identity 。</p>
<p>当 Identity scaffolder 运行时，将在项目目录中创建一个 <em>ScaffoldingReadme.txt</em> 文件。 <em>ScaffoldingReadme.txt</em> 文件包含有关完成基架更新所需内容的一般说明 Identity 。 本文档包含与 <em>ScaffoldingReadme.txt</em> 文件更完整的说明。</p>
<p>建议使用显示文件差异的源代码管理系统，并使您能够回退更改。 运行 scaffolder 后检查更改 Identity 。</p>
<div class="NOTE">
<h5>Note</h5>
<p>使用 <a class="xref" href="identity-enable-qrcodes.html">双重身份验证</a>、 <a class="xref" href="accconfirm.html">帐户确认和密码恢复</a>和其他安全功能时，需要提供服务 Identity 。 基架时不生成服务或服务存根 Identity 。 要启用这些功能，必须手动添加服务。 例如，请参阅 <a class="xref" href="accconfirm.html#require-email-confirmation">需要确认电子邮件</a>。</p>
</div>
<h2 id="scaffold-no-locidentity-into-an-empty-project">基架 Identity 到空项目</h2>
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong>  &gt;  <strong>新的基架项</strong>&quot;。</li>
<li>从 &quot;<strong>添加新的基架项</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot;  &gt;  <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，或将用错误的标记覆盖布局文件：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于 Razor Pages</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于 MVC 项目</li>
<li><code>blazorserver</code>默认情况下，不会为 Razor Pages 或 MVC 为 Blazor 服务器模板（）中创建的 Blazor 服务器应用配置。 将 &quot;布局页&quot; 项留空。</li>
</ul>
</li>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
</ul>
</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将所需的 NuGet 包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>如果出现基架错误，请验证目标框架名字对象 (TFM) 是否与项目文件中的 NuGet 包版本相匹配。 例如，以下项目文件包含适用于 .NET Core 的版本 3.1 和所列的 NuGet 包：</p>
<pre><code class="lang-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Web&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp3.1&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.UI&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Design&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Tools&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.VisualStudio.Web.CodeGeneration.Design&quot; Version=&quot;3.1.0&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>

<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity --useDefaultUI
</code></pre>
</section>
</div>

<p>将以下突出显示的调用添加到 <code>Startup</code> 类：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><p><code>UseHsts</code>建议，但不是必需的。 有关详细信息，请参阅<a class="xref" href="../enforcing-ssl.html#http-strict-transport-security-protocol-hsts">HTTP 严格传输安全协议</a>。</p>
<p>生成的标识数据库代码需要<a href="/ef/core/managing-schemas/migrations/">Entity Framework Core 迁移</a>。 创建迁移并更新数据库。 例如，运行以下命令：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>在 Visual Studio<strong>包管理器控制台</strong>中：</p>
<pre><code class="lang-powershell">Install-Package Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore
Add-Migration CreateIdentitySchema
Update-Database
</code></pre>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<pre><code class="lang-dotnetcli">dotnet ef migrations add CreateIdentitySchema
dotnet ef database update
</code></pre>
</section>
</div>

<p><code>Add-Migration</code> 命令的 &quot;CreateIdentitySchema&quot; name 参数是任意的。 <code>&quot;CreateIdentitySchema&quot;</code> 介绍迁移。</p>
<h2 id="scaffold-no-locidentity-into-a-no-locrazor-project-without-existing-authorization">基架 Identity 到 Razor 无现有授权的项目</h2>
<!--  Updated for 3.0
set projNam=RPnoAuth
set projType=webapp

dotnet new %projType% -o %projNam%
cd %projNam%
dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet restore
dotnet aspnet-codegenerator identity --useDefaultUI
dotnet ef migrations add CreateIdentitySchema
dotnet ef database update
-->
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong>  &gt;  <strong>新的基架项</strong>&quot;。</li>
<li>从 &quot;<strong>添加新的基架项</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot;  &gt;  <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，或将用错误的标记覆盖布局文件：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于 Razor Pages</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于 MVC 项目</li>
<li><code>blazorserver</code>默认情况下，不会为 Razor Pages 或 MVC 为 Blazor 服务器模板（）中创建的 Blazor 服务器应用配置。 将 &quot;布局页&quot; 项留空。</li>
</ul>
</li>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
</ul>
</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将所需的 NuGet 包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>如果出现基架错误，请验证目标框架名字对象 (TFM) 是否与项目文件中的 NuGet 包版本相匹配。 例如，以下项目文件包含适用于 .NET Core 的版本 3.1 和所列的 NuGet 包：</p>
<pre><code class="lang-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Web&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp3.1&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.UI&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Design&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Tools&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.VisualStudio.Web.CodeGeneration.Design&quot; Version=&quot;3.1.0&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>

<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity --useDefaultUI
</code></pre>
</section>
</div>

<p>Identity在 <em>区域/ Identity / Identity HostingStartup.cs</em> 中配置。 有关详细信息，请参阅 <a class="xref" href="../../fundamentals/host/platform-specific-configuration.html">IHostingStartup</a>。</p>
<p><a name="efm"></a></p>
<h3 id="migrations-useauthentication-and-layout">迁移、UseAuthentication 和布局</h3>
<p>生成的标识数据库代码需要<a href="/ef/core/managing-schemas/migrations/">Entity Framework Core 迁移</a>。 创建迁移并更新数据库。 例如，运行以下命令：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>在 Visual Studio<strong>包管理器控制台</strong>中：</p>
<pre><code class="lang-powershell">Install-Package Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore
Add-Migration CreateIdentitySchema
Update-Database
</code></pre>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<pre><code class="lang-dotnetcli">dotnet ef migrations add CreateIdentitySchema
dotnet ef database update
</code></pre>
</section>
</div>

<p><code>Add-Migration</code> 命令的 &quot;CreateIdentitySchema&quot; name 参数是任意的。 <code>&quot;CreateIdentitySchema&quot;</code> 介绍迁移。</p>

<p><a name="useauthentication"></a></p>
<h3 id="enable-authentication">启用身份验证</h3>
<p>在 <code>Configure</code> 类的方法中 <code>Startup</code> ，在以下情况下调用 &lt;xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication%2A&gt; <code>UseStaticFiles</code> ：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><p><code>UseHsts</code>建议，但不是必需的。 有关详细信息，请参阅<a class="xref" href="../enforcing-ssl.html#http-strict-transport-security-protocol-hsts">HTTP 严格传输安全协议</a>。</p>
<h3 id="layout-changes">布局更改</h3>
<p>可选：将登录部分 (<code>_LoginPartial</code>) 添加到布局文件中：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><h2 id="scaffold-no-locidentity-into-a-no-locrazor-project-with-authorization">Identity Razor 使用授权基架到项目中</h2>
<!--
Use >=2.1: dotnet new webapp -au Individual -o RPauth
Use = 2.0: dotnet new razor -au Individual -o RPauth
uld option: Use Local DB, not SQLite

dotnet new webapp -au Individual -uld -o RPauth
cd RPauth
dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet aspnet-codegenerator identity -dc RPauth.Data.ApplicationDbContext --files "Account.Register;Account.Register"
-->
<div range="&gt;= aspnetcore-3.0">
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong> &gt; <strong>新的基架项</strong>&quot;。</li>
<li>在 &quot;<strong>添加基架</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot; &gt; <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，以便不会用错误的标记覆盖布局文件。 如果选择了现有的* _ 布局 cshtml*文件，则<strong>不</strong>会覆盖它。 例如：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于包含现有 Razor Pages 基础结构 Razor Pages 或 Blazor 服务器项目</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于包含现有 MVC 基础结构的 MVC 项目或 Blazor 服务器项目</li>
</ul>
</li>
</ul>
</li>
<li>若要使用现有的数据上下文，请至少选择一个要重写的文件。 必须至少选择一个文件以添加数据上下文。
<ul>
<li>选择数据上下文类。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
<li>创建新的用户上下文，并可能为标识创建自定义用户类：
<ul>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
</ul>
<p>注意：如果要创建新的用户上下文，则无需选择要重写的文件。</p>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将所需的 NuGet 包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>如果出现基架错误，请验证目标框架名字对象 (TFM) 是否与项目文件中的 NuGet 包版本相匹配。 例如，以下项目文件包含适用于 .NET Core 的版本 3.1 和所列的 NuGet 包：</p>
<pre><code class="lang-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Web&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp3.1&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.UI&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Design&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Tools&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.VisualStudio.Web.CodeGeneration.Design&quot; Version=&quot;3.1.0&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>

<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令。 为数据库上下文使用正确的完全限定名：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login&quot;
</code></pre>
<p>PowerShell 使用分号作为命令分隔符。 使用 PowerShell 时，请在文件列表中转义分号，或将文件列表置于双引号中。 例如：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login;Account.Logout&quot;
</code></pre>
<p>如果在未指定标志或标志的情况下运行标识 scaffolder <code>--files</code> <code>--useDefaultUI</code> ，则会在项目中创建所有可用的标识 UI 页。</p>
</section>
</div>
</div>
<div range="&lt; aspnetcore-3.0">
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q-1_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong> &gt; <strong>新的基架项</strong>&quot;。</li>
<li>在 &quot;<strong>添加基架</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot; &gt; <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，否则将用错误的标记覆盖你的布局文件。 如果选择了现有的* _ 布局 cshtml*文件，则<strong>不</strong>会覆盖它。 例如：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于 Razor Pages</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于 MVC 项目</li>
</ul>
</li>
</ul>
</li>
<li>若要使用现有的数据上下文，请至少选择一个要重写的文件。 必须至少选择一个文件以添加数据上下文。
<ul>
<li>选择数据上下文类。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
<li>创建新的用户上下文，并可能为标识创建自定义用户类：
<ul>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
</ul>
<p>注意：如果要创建新的用户上下文，则无需选择要重写的文件。</p>
</section>
<section id="tabpanel_CeZOj-G++Q-1_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将对<a href="https://www.nuget.org/packages/Microsoft.VisualStudio.Web.CodeGeneration.Design/">VisualStudio</a>的包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet restore
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令。 为数据库上下文使用正确的完全限定名：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login&quot;
</code></pre>
<p>PowerShell 使用分号作为命令分隔符。 使用 PowerShell 时，请在文件列表中转义分号，或将文件列表置于双引号中。 例如：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login;Account.Logout&quot;
</code></pre>
<p>如果在未指定标志或标志的情况下运行标识 scaffolder <code>--files</code> <code>--useDefaultUI</code> ，则会在项目中创建所有可用的标识 UI 页。</p>
</section>
</div>
</div>

<p>某些 Identity 选项在 <em>区域/ Identity / Identity HostingStartup.cs</em> 中配置。 有关详细信息，请参阅 <a class="xref" href="../../fundamentals/host/platform-specific-configuration.html">IHostingStartup</a>。</p>
<h2 id="scaffold-no-locidentity-into-an-mvc-project-without-existing-authorization">基架 Identity 到没有现有授权的 MVC 项目</h2>
<!--
set projNam=MvcNoAuth
set projType=mvc
set version=2.1.0

dotnet new %projType% -o %projNam%
cd %projNam%
dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design -v %version%
dotnet restore
dotnet aspnet-codegenerator identity --useDefaultUI
dotnet ef migrations add CreateIdentitySchema
dotnet ef database update
-->
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong>  &gt;  <strong>新的基架项</strong>&quot;。</li>
<li>从 &quot;<strong>添加新的基架项</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot;  &gt;  <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，或将用错误的标记覆盖布局文件：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于 Razor Pages</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于 MVC 项目</li>
<li><code>blazorserver</code>默认情况下，不会为 Razor Pages 或 MVC 为 Blazor 服务器模板（）中创建的 Blazor 服务器应用配置。 将 &quot;布局页&quot; 项留空。</li>
</ul>
</li>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
</ul>
</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将所需的 NuGet 包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>如果出现基架错误，请验证目标框架名字对象 (TFM) 是否与项目文件中的 NuGet 包版本相匹配。 例如，以下项目文件包含适用于 .NET Core 的版本 3.1 和所列的 NuGet 包：</p>
<pre><code class="lang-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Web&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp3.1&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.UI&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Design&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Tools&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.VisualStudio.Web.CodeGeneration.Design&quot; Version=&quot;3.1.0&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>

<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity --useDefaultUI
</code></pre>
</section>
</div>

<p>可选：将登录名部分 (<code>_LoginPartial</code>) 添加到 <em>Views/Shared/_Layout</em> 文件中：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<ul>
<li>将 <em>Pages/shared/_LoginPartial cshtml</em> 文件移动到 <em>Views/shared/_LoginPartial。 cshtml</em></li>
</ul>
<p>Identity在 <em>区域/ Identity / Identity HostingStartup.cs</em> 中配置。 有关详细信息，请参阅 IHostingStartup。</p>
<p>生成的标识数据库代码需要<a href="/ef/core/managing-schemas/migrations/">Entity Framework Core 迁移</a>。 创建迁移并更新数据库。 例如，运行以下命令：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>在 Visual Studio<strong>包管理器控制台</strong>中：</p>
<pre><code class="lang-powershell">Install-Package Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore
Add-Migration CreateIdentitySchema
Update-Database
</code></pre>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<pre><code class="lang-dotnetcli">dotnet ef migrations add CreateIdentitySchema
dotnet ef database update
</code></pre>
</section>
</div>

<p><code>Add-Migration</code> 命令的 &quot;CreateIdentitySchema&quot; name 参数是任意的。 <code>&quot;CreateIdentitySchema&quot;</code> 介绍迁移。</p>

<p>调用 &lt;xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication%2A&gt; 后 <code>UseStaticFiles</code> ：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><p><code>UseHsts</code>建议，但不是必需的。 有关详细信息，请参阅<a class="xref" href="../enforcing-ssl.html#http-strict-transport-security-protocol-hsts">HTTP 严格传输安全协议</a>。</p>
<h2 id="scaffold-no-locidentity-into-an-mvc-project-with-authorization">Identity使用授权基架到 MVC 项目</h2>
<!--
dotnet new mvc -au Individual -o MvcAuth
cd MvcAuth
dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet restore
dotnet aspnet-codegenerator identity -dc MvcAuth.Data.ApplicationDbContext  --files "Account.Login;Account.Register"
-->
<div range="&gt;= aspnetcore-3.0">
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong> &gt; <strong>新的基架项</strong>&quot;。</li>
<li>在 &quot;<strong>添加基架</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot; &gt; <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，以便不会用错误的标记覆盖布局文件。 如果选择了现有的* _ 布局 cshtml*文件，则<strong>不</strong>会覆盖它。 例如：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于包含现有 Razor Pages 基础结构 Razor Pages 或 Blazor 服务器项目</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于包含现有 MVC 基础结构的 MVC 项目或 Blazor 服务器项目</li>
</ul>
</li>
</ul>
</li>
<li>若要使用现有的数据上下文，请至少选择一个要重写的文件。 必须至少选择一个文件以添加数据上下文。
<ul>
<li>选择数据上下文类。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
<li>创建新的用户上下文，并可能为标识创建自定义用户类：
<ul>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
</ul>
<p>注意：如果要创建新的用户上下文，则无需选择要重写的文件。</p>
</section>
<section id="tabpanel_CeZOj-G++Q_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将所需的 NuGet 包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
dotnet add package Microsoft.AspNetCore.Identity.UI
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>如果出现基架错误，请验证目标框架名字对象 (TFM) 是否与项目文件中的 NuGet 包版本相匹配。 例如，以下项目文件包含适用于 .NET Core 的版本 3.1 和所列的 NuGet 包：</p>
<pre><code class="lang-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk.Web&quot;&gt;

  &lt;PropertyGroup&gt;
    &lt;TargetFramework&gt;netcoreapp3.1&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.EntityFrameworkCore&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.AspNetCore.Identity.UI&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Design&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.SqlServer&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.EntityFrameworkCore.Tools&quot; Version=&quot;3.1.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Microsoft.VisualStudio.Web.CodeGeneration.Design&quot; Version=&quot;3.1.0&quot; /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>

<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令。 为数据库上下文使用正确的完全限定名：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login&quot;
</code></pre>
<p>PowerShell 使用分号作为命令分隔符。 使用 PowerShell 时，请在文件列表中转义分号，或将文件列表置于双引号中。 例如：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login;Account.Logout&quot;
</code></pre>
<p>如果在未指定标志或标志的情况下运行标识 scaffolder <code>--files</code> <code>--useDefaultUI</code> ，则会在项目中创建所有可用的标识 UI 页。</p>
</section>
</div>
</div>
<div range="&lt; aspnetcore-3.0">
<p>运行标识 scaffolder：</p>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_netcore-cli" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_netcore-cli" data-tab="netcore-cli" tabindex="-1">.NET Core CLI</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q-1_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>在<strong>解决方案资源管理器</strong>中，右键单击项目 &gt; &quot;<strong>添加</strong> &gt; <strong>新的基架项</strong>&quot;。</li>
<li>在 &quot;<strong>添加基架</strong>&quot; 对话框的左窗格中，选择 &quot;<strong>标识</strong>&quot; &quot; &gt; <strong>添加</strong>&quot;。</li>
<li>在 &quot;<strong>添加标识</strong>&quot; 对话框中，选择所需的选项。
<ul>
<li>选择现有的布局页，否则将用错误的标记覆盖你的布局文件。 如果选择了现有的* _ 布局 cshtml*文件，则<strong>不</strong>会覆盖它。 例如：
<ul>
<li><code>~/Pages/Shared/_Layout.cshtml</code>对于 Razor Pages</li>
<li><code>~/Views/Shared/_Layout.cshtml</code>对于 MVC 项目</li>
</ul>
</li>
</ul>
</li>
<li>若要使用现有的数据上下文，请至少选择一个要重写的文件。 必须至少选择一个文件以添加数据上下文。
<ul>
<li>选择数据上下文类。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
<li>创建新的用户上下文，并可能为标识创建自定义用户类：
<ul>
<li>选择 <strong>+</strong> 按钮以创建新的<strong>数据上下文类</strong>。 接受默认值或指定类（例如 <code>MyApplication.Data.ApplicationDbContext</code> ）。</li>
<li>选择 <strong>添加</strong> 。</li>
</ul>
</li>
</ul>
<p>注意：如果要创建新的用户上下文，则无需选择要重写的文件。</p>
</section>
<section id="tabpanel_CeZOj-G++Q-1_netcore-cli" role="tabpanel" data-tab="netcore-cli" aria-hidden="true" hidden="hidden">

<p>如果你之前未安装 ASP.NET Core scaffolder，请立即安装：</p>
<pre><code class="lang-dotnetcli">dotnet tool install -g dotnet-aspnet-codegenerator
</code></pre>
<p>将对<a href="https://www.nuget.org/packages/Microsoft.VisualStudio.Web.CodeGeneration.Design/">VisualStudio</a>的包引用添加到项目文件（<em>.csproj</em>）。 在项目目录中运行以下命令：</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet restore
</code></pre>
<p>运行以下命令以列出 Identity scaffolder 选项：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -h
</code></pre>
<p>在项目文件夹中，运行具有所需选项的标识 scaffolder。 例如，若要设置默认 UI 和最小文件数的标识，请运行以下命令。 为数据库上下文使用正确的完全限定名：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login&quot;
</code></pre>
<p>PowerShell 使用分号作为命令分隔符。 使用 PowerShell 时，请在文件列表中转义分号，或将文件列表置于双引号中。 例如：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc MyApplication.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login;Account.Logout&quot;
</code></pre>
<p>如果在未指定标志或标志的情况下运行标识 scaffolder <code>--files</code> <code>--useDefaultUI</code> ，则会在项目中创建所有可用的标识 UI 页。</p>
</section>
</div>
</div>

<p>删除 <em>页面/共享</em> 文件夹和该文件夹中的文件。</p>
<p><a name="full"></a></p>
<h2 id="create-full-no-locidentity-ui-source">创建完整的 Identity UI 源</h2>
<p>若要维护 UI 的完全控制 Identity ，请运行 Identity scaffolder 并选择 &quot; <strong>替代所有文件</strong> &quot;。</p>
<p>以下突出显示的代码显示了将默认 UI 替换为 Identity Identity ASP.NET Core 2.1 web 应用中的更改。 你可能希望执行此操作以对 UI 具有完全控制 Identity 。</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>Identity在以下代码中，将替换默认值：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>下面的代码将设置 <a href="/dotnet/api/microsoft.aspnetcore.authentication.cookies.cookieauthenticationoptions.loginpath">LoginPath</a>、 <a href="/dotnet/api/microsoft.aspnetcore.authentication.cookies.cookieauthenticationoptions.logoutpath">LogoutPath</a>和 <a href="/dotnet/api/microsoft.aspnetcore.authentication.cookies.cookieauthenticationoptions.accessdeniedpath">AccessDeniedPath</a>：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>注册 <code>IEmailSender</code> 实现，例如：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><!--
uld option: Use Local DB, not SQLite

dotnet new webapp -au Individual -uld -o RPauth
cd RPauth
dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet aspnet-codegenerator identity -dc RPauth.Data.ApplicationDbContext --files "Account.Register;Account.Login;Account.RegisterConfirmation"
-->
<h2 id="password-configuration">密码配置</h2>
<p>如果 &lt;xref:Microsoft.AspNetCore.Identity.PasswordOptions&gt; 在中配置了 <code>Startup.ConfigureServices</code> ，则基架页中的属性可能需要<a href="xref:System.ComponentModel.DataAnnotations.StringLengthAttribute"> <code>[StringLength]</code> 属性</a>配置 <code>Password</code> Identity 。 <code>InputModel``Password</code>在以下文件中可以找到属性：</p>
<ul>
<li><code>Areas/Identity/Pages/Account/Register.cshtml.cs</code></li>
<li><code>Areas/Identity/Pages/Account/ResetPassword.cshtml.cs</code></li>
</ul>
<h2 id="disable-register-page">禁用注册页</h2>
<p>禁用用户注册：</p>
<ul>
<li><p>基架 Identity 。 包括帐户. Register、RegisterConfirmation。 例如：</p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator identity -dc RPauth.Data.ApplicationDbContext --files &quot;Account.Register;Account.Login;Account.RegisterConfirmation&quot;
</code></pre>
</li>
<li><p>更新 <em>区域/ Identity /Pages/Account/Register.cshtml.cs</em> ，使用户无法从此终结点注册：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div></li>
<li><p>更新 <em>区域/ Identity /Pages/Account/Register.cshtml</em> ，使其与前面的更改一致：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div></li>
<li><p>注释掉或删除 <em>区域/ Identity /Pages/Account/Login.cshtml</em> 中的注册链接</p>
</li>
</ul>
<pre><code class="lang-cshtml">@*
&lt;p&gt;
    &lt;a asp-page=&quot;./Register&quot; asp-route-returnUrl=&quot;@Model.ReturnUrl&quot;&gt;Register as a new user&lt;/a&gt;
&lt;/p&gt;
*@
</code></pre>
<ul>
<li><p>更新 &quot; <em>区域/ Identity /Pages/Account/RegisterConfirmation</em> &quot; 页。</p>
<ul>
<li>删除来自 cshtml 文件的代码和链接。</li>
<li>从中删除确认代码 <code>PageModel</code> ：</li>
</ul>
<pre><code class="lang-csharp">[AllowAnonymous]
  public class RegisterConfirmationModel : PageModel
  {
      public IActionResult OnGet()
      {  
          return Page();
      }
  }
</code></pre>
</li>
</ul>
<h3 id="use-another-app-to-add-users">使用其他应用添加用户</h3>
<p>提供一种在 web 应用外部添加用户的机制。 用于添加用户的选项包括：</p>
<ul>
<li>专用的管理 web 应用。</li>
<li>控制台应用。</li>
</ul>
<p>下面的代码概述了一种添加用户的方法：</p>
<ul>
<li>用户列表将读入内存中。</li>
<li>为每个用户生成一个强唯一密码。</li>
<li>用户已添加到 Identity 数据库。</li>
<li>系统会通知用户并通知用户更改密码。</li>
</ul>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>下面的代码概述了如何添加用户：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>对于生产方案，可以遵循类似的方法。</p>
<h2 id="additional-resources">其他资源</h2>
<ul>
<li><a class="xref" href="../../migration/20_21.html#changes-to-authentication-code">更改为 ASP.NET Core 2.1 及更高版本的身份验证代码</a></li>
</ul>
</div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
