<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>ASP.NET Core 2.2 &#30340;&#26032;&#22686;&#21151;&#33021; </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="ASP.NET Core 2.2 &#30340;&#26032;&#22686;&#21151;&#33021; ">
    <meta name="generator" content="docfx 2.56.4.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="/foo">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="aspnetcore-2.2">
<h1 id="whats-new-in-aspnet-core-22">ASP.NET Core 2.2 的新增功能</h1>

<p>本文重点介绍 ASP.NET Core 2.2 中最重要的更改，并提供相关文档的链接。</p>
<h2 id="openapi-analyzers--conventions">开放 API 分析器和约定</h2>
<p>开放 API（以前称为 Swagger）是一个与语言无关的规范，用于描述 REST API。 开放 API 生态系统具有一些工具，可用于发现、测试和生成使用该规范的客户端代码。 对在 ASP.NET Core MVC 中生成和直观呈现 OpenAPI 文档的支持是通过社区驱动项目（如 <a href="https://github.com/RicoSuter/NSwag">NSwag</a> 和 <a href="https://github.com/domaindrivendev/Swashbuckle.AspNetCore">Swashbuckle.AspNetCore</a>）提供。 对于创建开放 API 文档，ASP.NET Core 2.2 提供了改进的工具和运行时体验。</p>
<p>有关更多信息，请参见以下资源：</p>
<ul>
<li><a class="xref" href="../web-api/advanced/analyzers.html">使用 Web API 分析器</a></li>
<li><a class="xref" href="../web-api/advanced/conventions.html">使用 Web API 约定</a></li>
<li><a href="https://blogs.msdn.microsoft.com/webdev/2018/08/23/asp-net-core-2-20-preview1-open-api-analyzers-conventions/">ASP.NET Core 2.2.0-preview1：开放 API 分析器和约定</a></li>
</ul>
<h2 id="problem-details-support">问题详细信息支持</h2>
<p>ASP.NET Core 2.1 引入了 <code>ProblemDetails</code>（基于用于通过 HTTP 响应传送错误详细信息的 <a href="https://tools.ietf.org/html/rfc7807">RFC 7807</a> 规范）。 在 2.2 中，<code>ProblemDetails</code> 是针对具有 <code>ApiControllerAttribute</code> 特性的控制器中客户端错误代码的标准响应。 返回客户端错误状态代码 (4xx) 的 <code>IActionResult</code> 现在返回 <code>ProblemDetails</code> 正文。 结果还包括可以用于将使用请求日志的错误相关联的关联 ID。 对于客户端错误，<code>ProducesResponseType</code> 默认为使用 <code>ProblemDetails</code> 作为响应类型。 这会记录在使用 NSwag 或 Swashbuckle.AspNetCore 生成的开放 API/Swagger 输出中。</p>
<h2 id="endpoint-routing">终结点路由</h2>
<p>ASP.NET Core 2.2 使用新的终结点路由  系统来改进请求的调度。 更改包括新链接生成 API 成员和路由参数转换器。</p>
<p>有关更多信息，请参见以下资源：</p>
<ul>
<li><a href="https://blogs.msdn.microsoft.com/webdev/2018/08/27/asp-net-core-2-2-0-preview1-endpoint-routing/">2.2 中的终结点路由</a></li>
<li><a href="https://www.hanselman.com/blog/ASPNETCore22ParameterTransformersForCleanURLGenerationAndSlugsInRazorPagesOrMVC.aspx">路由参数转换器</a>（请参阅“路由”  部分）</li>
<li><a class="xref" href="../fundamentals/routing.html?view=aspnetcore-2.2#differences-from-earlier-versions-of-routing">基于 IRouter 与基于终结点的路由之间的差异</a></li>
</ul>
<h2 id="health-checks">运行状况检查</h2>
<p>通过新的运行状况检查服务可以更轻松地在需要运行状况检查的环境（如 Kubernetes）中使用 ASP.NET Core。 运行状况检查包括中间件和一组定义 <code>IHealthCheck</code> 抽象和服务的库。</p>
<p>运行状况检查由容器业务流程协调程序或负载均衡器用于快速确定系统是否正常响应请求。 容器业务流程协调程序可以通过停止滚动部署或重新启动容器来响应失败的运行状况检查。 负载均衡器可以通过路由流量以避开失败的服务实例，来响应运行状况检查。</p>
<p>运行状况检查由应用程序公开为监视系统所使用的 HTTP 终结点。 可以为各种实时监视方案和监视系统配置运行状况检查。 运行状况检查服务与 <a href="https://github.com/Xabaril/BeatPulse">BeatPulse 项目</a>集成。 从而可以更轻松地添加为众多常用系统和依赖项添加检查。</p>
<p>有关详细信息，请参阅 <a class="xref" href="../host-and-deploy/health-checks.html">ASP.NET Core 中的运行状况检查</a>。</p>
<h2 id="http2-in-kestrel">Kestrel 中的 HTTP/2</h2>
<p>ASP.NET Core 2.2 添加了对 HTTP/2 的支持。</p>
<p>HTTP/2 是 HTTP 协议的主要修订版本。 HTTP/2 的重要功能包括：</p>
<ul>
<li>标头压缩支持。</li>
<li>单个连接上的完全多路复用流。</li>
</ul>
<p>尽管 HTTP/2 保留了 HTTP 的语义（如 HTTP 标头和方法），不过与 HTTP/1.x 相比，在客户端和服务器之间对此数据进行组帧和发送的方式发生了重大更改。</p>
<p>由于组帧中的这一更改，服务器和客户端需要协商所使用的协议版本。 应用层协议协商 (ALPN) 是一种 TLS 扩展，允许服务器和客户端协商用作其 TLS 握手一部分的协议版本。 虽然服务器与客户端之间可以事先了解协议，不过所有主要浏览器都支持 ALPN 作为建立 HTTP/2 连接的唯一方法。</p>
<p>有关详细信息，请参阅 <a class="xref" href="../fundamentals/servers/index.html?view=aspnetcore-2.2#http2-support">HTTP/2 支持</a>。</p>
<h2 id="kestrel-configuration">Kestrel 配置</h2>
<p>在早期版本的 ASP.NET Core 中，Kestrel 选项通过调用 <code>UseKestrel</code> 来配置。 在 2.2 中，Kestrel 选项通过在主机生成器上调用 <code>ConfigureKestrel</code> 来配置。 此更改为进程内承载解决了 <code>IServer</code> 注册顺序方面的问题。 有关更多信息，请参见以下资源：</p>
<ul>
<li><a href="https://github.com/aspnet/KestrelHttpServer/issues/2760">缓解 UseIIS 冲突</a></li>
<li><a class="xref" href="../fundamentals/servers/kestrel.html?view=aspnetcore-2.2#how-to-use-kestrel-in-aspnet-core-apps">使用 ConfigureKestrel 配置 Kestrel 服务器选项</a></li>
</ul>
<h2 id="iis-in-process-hosting">IIS 进程内承载</h2>
<p>在早期版本的 ASP.NET Core 中，IIS 用作反向代理。 在 2.2 中，ASP.NET Core 模块可以启动 CoreCLR 并在 IIS 工作进程 (w3wp.exe  ) 内承载应用。 在使用 IIS 运行时，进程内承载可提供性能和诊断提升。</p>
<p>有关详细信息，请参阅 <a class="xref" href="../host-and-deploy/aspnet-core-module.html?view=aspnetcore-2.2#in-process-hosting-model">IIS 进程内承载</a>。</p>
<h2 id="no-locsignalr-java-client">SignalR Java 客户端</h2>
<p>ASP.NET Core 2.2 引入了适用于 SignalR 的 Java 客户端。 此客户端支持通过 Java 代码连接到 ASP.NET Core SignalR Server（包括 Android 应用）。</p>
<p>有关详细信息，请参阅 <a href="../signalr/java-client.html?view=aspnetcore-2.2">ASP.NET Core SignalR Java 客户端</a>。</p>
<h2 id="cors-improvements">CORS 改进</h2>
<p>在早期版本的 ASP.NET Core 中，CORS 中间件允许发送 <code>Accept</code>、<code>Accept-Language</code>、<code>Content-Language</code> 和 <code>Origin</code> 标头（不考虑在 <code>CorsPolicy.Headers</code> 中配置的值）。 在 2.2 中，仅当在 <code>Access-Control-Request-Headers</code> 中发送的标头与 <code>WithHeaders</code> 中声明的标头完全匹配时，才能进行 CORS 中间件策略匹配。</p>
<p>有关详细信息，请参阅 <a class="xref" href="../security/cors.html?view=aspnetcore-2.2#set-the-allowed-request-headers">CORS 中间件</a>。</p>
<h2 id="response-compression">响应压缩</h2>
<p>ASP.NET Core 2.2 可以使用 <a href="https://tools.ietf.org/html/rfc7932">Brotli 压缩格式</a>来压缩响应。</p>
<p>有关详细信息，请参阅<a class="xref" href="../performance/response-compression.html?view=aspnetcore-2.2#brotli-compression-provider">响应压缩中间件支持 Brotli 压缩</a>。</p>
<h2 id="project-templates">项目模板</h2>
<p>ASP.NET Core Web 项目模板已更新为 <a href="https://getbootstrap.com/docs/4.1/migration/">Bootstrap 4</a> 和 <a href="https://blog.angular.io/version-6-of-angular-now-available-cc56b0efa7a4">Angular 6</a>。 新的外观在视觉上更简单，可以更轻松地查看应用的重要结构。</p>
<p><img src="../tutorials/razor-pages/razor-pages-start/_static/home2.2.png" alt="主页或索引页"></p>
<h2 id="validation-performance">验证性能</h2>
<p>根据设计，MVC 的验证系统具有可扩展性和灵活性，让你能够基于每个请求确定应用于给定模型的验证程序。 这非常适用于创作复杂的验证提供程序。 但最常见的情况是，应用程序仅使用内置验证程序，不需要这种额外的灵活性。 内置验证程序包括 DataAnnotations（如 [Required] 和 [StringLength]）和 <code>IValidatableObject</code>。</p>
<p>在 ASP.NET Core 2.2 中，如果 MVC 确定给定模型关系图不需要验证，则可以绕过验证。 在验证无法具有或不具有任何验证程序的模型时，跳过验证可获得显著改进。 这包括诸如基元集合（如 <code>byte[]</code>、<code>string[]</code>、<code>Dictionary&lt;string, string&gt;</code> ）之类的对象，或没有许多验证程序的复杂对象关系图。</p>
<h2 id="http-client-performance">HTTP 客户端性能</h2>
<p>在 ASP.NET Core 2.2 中，通过减少连接池锁定争用提高了 <code>SocketsHttpHandler</code> 的性能。 对于进行大量传出 HTTP 请求的应用（如某些微服务体系结构），吞吐量得到了提高。 在负载下，<code>HttpClient</code> 吞吐量在 Linux 上可以提高多达 60%，在 Windows 上提高多达 20%。</p>
<p>有关详细信息，请参阅<a href="https://github.com/dotnet/corefx/pull/32568">实现此改进的拉取请求</a>。</p>
<h2 id="additional-information">其他信息</h2>
<p>要获取完整的更改列表，请参阅 <a href="https://github.com/dotnet/aspnetcore/releases/tag/2.2.0">ASP.NET Core 2.2 发行说明</a>。</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
