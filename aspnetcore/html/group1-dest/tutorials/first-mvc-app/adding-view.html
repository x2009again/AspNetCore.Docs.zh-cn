<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#31532; 3 &#37096;&#20998;&#65292;&#23558;&#35270;&#22270;&#28155;&#21152;&#21040; ASP.NET Core MVC &#24212;&#29992; </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#31532; 3 &#37096;&#20998;&#65292;&#23558;&#35270;&#22270;&#28155;&#21152;&#21040; ASP.NET Core MVC &#24212;&#29992; ">
    <meta name="generator" content="docfx 2.56.4.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="/foo">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="tutorials/first-mvc-app/adding-view">
<h1 id="part-3-add-a-view-to-an-aspnet-core-mvc-app">第 3 部分，将视图添加到 ASP.NET Core MVC 应用</h1>

<p>作者：<a href="https://twitter.com/RickAndMSFT">Rick Anderson</a></p>
<div range="&gt;= aspnetcore-3.0">
<p>在本部分中，将修改 <code>HelloWorldController</code> 类，进而使用 <a class="xref" href="../../mvc/views/razor.html">Razor</a> 视图文件来顺利封装为客户端生成 HTML 响应的过程。</p>
<p>使用 Razor 创建视图模板文件。 基于 Razor 的视图模板具有 .cshtml 文件扩展名。 它们提供了一种巧妙的方法来使用 C# 创建 HTML 输出。</p>
<p>当前，<code>Index</code> 方法返回带有在控制器类中硬编码的消息的字符串。 在 <code>HelloWorldController</code> 类中，将 <code>Index</code> 方法替换为以下代码：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>上面的代码调用控制器的 &lt;xref:Microsoft.AspNetCore.Mvc.Controller.View*&gt; 方法。 它使用视图模板来生成 HTML 响应。 控制器方法（亦称为“操作方法”，如上面的 <code>Index</code> 方法）通常返回 &lt;xref:Microsoft.AspNetCore.Mvc.IActionResult&gt;（或派生自 &lt;xref:Microsoft.AspNetCore.Mvc.ActionResult&gt; 的类），而不是 <code>string</code> 等类型。</p>
<h2 id="add-a-view">添加视图</h2>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio-code" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio-code" data-tab="visual-studio-code" tabindex="-1">Visual Studio Code</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q_visual-studio-mac" role="tab" aria-controls="tabpanel_CeZOj-G++Q_visual-studio-mac" data-tab="visual-studio-mac" tabindex="-1">Visual Studio for Mac</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li><p>右键单击“视图”文件夹，然后单击“添加”&gt;“新文件夹”，并将文件夹命名为“HelloWorld”。</p>
</li>
<li><p>右键单击“Views/HelloWorld”文件夹，然后单击“添加”&gt;“新项”。</p>
</li>
<li><p>在“添加新项 - MvcMovie”对话框中</p>
<ul>
<li><p>在右上角的搜索框中，输入“视图”</p>
</li>
<li><p>选择“Razor 视图”</p>
</li>
<li><p>保持“名称”框的值：Index.cshtml。</p>
</li>
<li><p>选择“添加”</p>
</li>
</ul>
</li>
</ul>
<p><img src="adding-view/_static/add_view.png" alt="“添加新项”对话框"></p>
</section>
<section id="tabpanel_CeZOj-G++Q_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<p>为 <code>HelloWorldController</code> 添加 <code>Index</code> 视图。</p>
<ul>
<li>添加一个名为“Views/HelloWorld”的新文件夹。</li>
<li>向 Views/HelloWorld 文件夹添加名为“Index.cshtml”的新文件。</li>
</ul>
</section>
<section id="tabpanel_CeZOj-G++Q_visual-studio-mac" role="tabpanel" data-tab="visual-studio-mac" aria-hidden="true" hidden="hidden">

<ul>
<li><p>右键单击“视图”文件夹，然后单击“添加”&gt;“新文件夹”，并将文件夹命名为“HelloWorld”。</p>
</li>
<li><p>右键单击“Views/HelloWorld”文件夹，然后单击“添加”&gt;“新文件”。</p>
</li>
<li><p>在“新建文件”对话框中：</p>
<ul>
<li>在左侧窗格中，选择“ASP.NET Core”。</li>
<li>在中间窗格中，选择“MVC 视图页面”。</li>
<li>在“名称”框中键入“Index”。</li>
<li>选择“新建”。</li>
</ul>
</li>
</ul>
<p><img src="adding-view/_static/add_view_mac.png" alt="“添加新项”对话框"></p>
</section>
</div>

<p>使用以下内容替换 Razor 视图文件 Views/HelloWorld/Index.cshtml 的内容：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>导航到 <code>https://localhost:{PORT}/HelloWorld</code>。 <code>HelloWorldController</code> 中的 <code>Index</code> 方法作用不大；它运行 <code>return View();</code> 语句，指定此方法应使用视图模板文件来呈现对浏览器的响应。 由于未指定视图模板文件名称，MVC 默认使用默认视图文件。 默认视图文件具有与方法 (<code>Index</code>) 相同的名称，因此在 /Views/HelloWorld/Index.cshtml 中使用视图模板。 下面图片显示了视图中硬编码的 字符串“Hello from our View Template!”</p>
<p><img src="adding-view/_static/hell_template.png" alt="浏览器窗口"></p>
<h2 id="change-views-and-layout-pages">更改视图和布局页面</h2>
<p>选择菜单链接（“MvcMovie”、“首页”和“隐私”）  。 每页显示相同的菜单布局。 菜单布局是在 Views/Shared/_Layout.cshtml 文件中实现的。 打开 Views/Shared/_Layout.cshtml 文件。</p>
<p><a class="xref" href="../../mvc/views/layout.html">布局</a>模板使你能够在一个位置指定网站的 HTML 容器布局，然后将它应用到网站中的多个页面。 查找 <code>@RenderBody()</code> 行。 <code>RenderBody</code> 是显示创建的所有特定于视图的页面的占位符，已包装在布局页面中。 例如，如果选择“隐私”链接，Views/Home/Privacy.cshtml 视图将在 <code>RenderBody</code> 方法中呈现 。</p>
<h2 id="change-the-title-footer-and-menu-link-in-the-layout-file">更改布局文件中的标题、页脚和菜单链接</h2>
<p>将 Views/Shared/_Layout.cshtml 文件的内容替换为以下标记。 突出显示所作更改：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>上述标记进行以下更改：</p>
<ul>
<li><code>MvcMovie</code> 更改为 <code>Movie App</code> 3 次。</li>
<li>定位点元素 <code>&lt;a class=&quot;navbar-brand&quot; asp-area=&quot;&quot; asp-controller=&quot;Home&quot; asp-action=&quot;Index&quot;&gt;MvcMovie&lt;/a&gt;</code> 更改为 <code>&lt;a class=&quot;navbar-brand&quot; asp-controller=&quot;Movies&quot; asp-action=&quot;Index&quot;&gt;Movie App&lt;/a&gt;</code>。</li>
</ul>
<p>在前面的标记中，省略了 <code>asp-area=&quot;&quot;</code> <a class="xref" href="../../mvc/views/tag-helpers/built-in/anchor-tag-helper.html">定位点标记帮助程序属性</a>和属性值，因为此应用未使用<a class="xref" href="../../mvc/controllers/areas.html">区域</a>。</p>
<p><strong>说明</strong>：<code>Movies</code> 控制器尚未实现。 此时，<code>Movie App</code> 链接不起作用。</p>
<p>保存更改并选择“隐私”链接。 请注意浏览器选项卡上的标题现在显示的是“隐私策略 - 电影应用”，而不是“隐私策略 - Mvc 电影”：</p>
<p><img src="adding-view/_static/about2.png" alt="“隐私”选项卡"></p>
<p>选择“主页”链接，请注意，标题和定位文本还会显示“电影应用” 。 我们能够在布局模板中进行一次更改，让网站上的所有页面都反映新的链接文本和新标题。</p>
<p>检查 Views/_ViewStart.cshtml 文件：</p>
<pre><code class="lang-cshtml">@{
    Layout = &quot;_Layout&quot;;
}
</code></pre>
<p>Views/_ViewStart.cshtml 文件将 Views/Shared/_Layout.cshtml 文件引入到每个视图中 。 可以使用 <code>Layout</code> 属性设置不同的布局视图，或将它设置为 <code>null</code>，这样将不会使用任何布局文件。</p>
<p>更改 Views/HelloWorld/Index.cshtml 视图文件的 <code>&lt;h2&gt;</code> 元素：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>稍稍对标题和 <code>&lt;h2&gt;</code> 元素进行一些更改，这样可以看出哪一段代码更改了显示。</p>
<p>上述代码中的 <code>ViewData[&quot;Title&quot;] = &quot;Movie List&quot;;</code> 将 <code>ViewData</code> 字典的 <code>Title</code> 属性设置为“Movie List”。 <code>Title</code> 属性在布局页面中的 <code>&lt;title&gt;</code> HTML 元素中使用：</p>
<pre><code class="lang-cshtml">&lt;title&gt;@ViewData[&quot;Title&quot;] - Movie App&lt;/title&gt;
</code></pre>
<p>保存更改并导航到 <code>https://localhost:{PORT}/HelloWorld</code>。 请注意，浏览器标题、主标题和辅助标题已更改。 （如果没有在浏览器中看到更改，则可能正在查看缓存的内容。 在浏览器中按 Ctrl + F5 强制加载来自服务器的响应。）浏览器标题是使用我们在 Index.cshtml 视图模板中设置的 <code>ViewData[&quot;Title&quot;]</code> 以及在布局文件中添加的额外“ - Movie App”创建的。</p>
<p>Index.cshtml 视图模板中的内容与 Views/Shared/_Layout.cshtml 视图模板合并 。 单个 HTML 响应将发送到浏览器。 凭借布局模板可以轻松地对应用中所有页面进行更改。 若要了解更多信息，请参阅<a class="xref" href="../../mvc/views/layout.html">布局</a>。</p>
<p><img src="adding-view/_static/hell3.png" alt="电影列表视图"></p>
<p>但我们这一点点“数据”（在此示例中为“Hello from our View Template!” 消息）是硬编码的。 MVC 应用程序有一个“V”（视图），而你已有一个“C”（控制器），但还没有“M”（模型）。</p>
<h2 id="passing-data-from-the-controller-to-the-view">将数据从控制器传递给视图</h2>
<p>控制器操作会被调用以响应传入的 URL 请求。 控制器类是编写处理传入浏览器请求的代码的地方。 控制器从数据源检索数据，并决定将哪些类型的响应发送回浏览器。 可以从控制器使用视图模板来生成并格式化对浏览器的 HTML 响应。</p>
<p>控制器负责提供所需的数据，使视图模板能够呈现响应。 最佳做法：视图模板不应该直接执行业务逻辑或与数据库进行交互。 相反，视图模板应仅使用由控制器提供给它的数据。 保持此“分离关注点”有助于保持代码干净以及可测试性和可维护性。</p>
<p>目前，<code>HelloWorldController</code> 类中的 <code>Welcome</code> 方法采用 <code>name</code> 和 <code>ID</code> 参数，然后将值直接输出到浏览器。 应将控制器更改为使用视图模板，而不是使控制器将此响应呈现为字符串。 视图模板会生成动态响应，这意味着必须将适当的数据位从控制器传递给视图以生成响应。 为此，可以让控制器将视图模板所需的动态数据（参数）放置在视图模板稍后可以访问的 <code>ViewData</code> 字典中。</p>
<p>在 HelloWorldController.cs 中，更改 <code>Welcome</code> 方法以将 <code>Message</code> 和 <code>NumTimes</code> 值添加到 <code>ViewData</code> 字典。 <code>ViewData</code> 字典是一个动态对象，这意味着可以使用任何类型；只有将内容放在其中后 <code>ViewData</code> 对象才具有定义的属性。 <a class="xref" href="../../mvc/models/model-binding.html">MVC 模型绑定系统</a>自动将命名参数（<code>name</code> 和 <code>numTimes</code>）从地址栏中的查询字符串映射到方法中的参数。 完整的 HelloWorldController.cs 文件如下所示：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p><code>ViewData</code> 字典对象包含将传递给视图的数据。</p>
<p>创建一个名为 Views/HelloWorld/Welcome.cshtml 的 Welcome 视图模板。</p>
<p>在 Welcome.cshtml 视图模板中创建一个循环，显示“Hello” <code>NumTimes</code>。 使用以下内容替换 Views/HelloWorld/Welcome.cshtml 的内容：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>保存更改并浏览到以下 URL：</p>
<p><code>https://localhost:{PORT}/HelloWorld/Welcome?name=Rick&amp;numtimes=4</code></p>
<p>数据取自 URL，并传递给使用 <a class="xref" href="../../mvc/models/model-binding.html">MVC 模型绑定器</a>的控制器。 控制器将数据打包到 <code>ViewData</code> 字典中，并将该对象传递给视图。 然后，视图将数据作为 HTML 呈现给浏览器。</p>
<p><img src="adding-view/_static/rick2.png" alt="“隐私”视图，显示了 Welcome 标签以及四个“Hello Rick”短语"></p>
<p>在上面的示例中，我们使用 <code>ViewData</code> 字典将数据从控制器传递给视图。 稍后在本教程中，我们将使用视图模型将数据从控制器传递给视图。 传递数据的视图模型方法通常比 <code>ViewData</code> 字典方法更为优先。 有关详细信息，请参阅<a href="https://www.rachelappel.com/when-to-use-viewbag-viewdata-or-tempdata-in-asp-net-mvc-3-applications/">何时使用 ViewBag、ViewData 或 TempData</a>。</p>
<p>在下一个教程中，将创建电影数据库。</p>
<div class="step-by-step">
<p><a href="adding-controller.html">上一页</a>
<a href="adding-model.html">下一页</a></p>
</div>
</div>
<div range="&lt; aspnetcore-3.0">
<p>在本部分中，将修改 <code>HelloWorldController</code> 类，进而使用 <a class="xref" href="../../mvc/views/razor.html">Razor</a> 视图文件来顺利封装为客户端生成 HTML 响应的过程。</p>
<p>使用 Razor 创建视图模板文件。 基于 Razor 的视图模板具有 .cshtml 文件扩展名。 它们提供了一种巧妙的方法来使用 C# 创建 HTML 输出。</p>
<p>当前，<code>Index</code> 方法返回带有在控制器类中硬编码的消息的字符串。 在 <code>HelloWorldController</code> 类中，将 <code>Index</code> 方法替换为以下代码：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>上面的代码调用控制器的 &lt;xref:Microsoft.AspNetCore.Mvc.Controller.View*&gt; 方法。 它使用视图模板来生成 HTML 响应。 控制器方法（亦称为“操作方法”，如上面的 <code>Index</code> 方法）通常返回 &lt;xref:Microsoft.AspNetCore.Mvc.IActionResult&gt;（或派生自 &lt;xref:Microsoft.AspNetCore.Mvc.ActionResult&gt; 的类），而不是 <code>string</code> 等类型。</p>
<h2 id="add-a-view">添加视图</h2>
<div class="tabGroup" id="tabgroup_CeZOj-G++Q-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_visual-studio" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_visual-studio-code" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_visual-studio-code" data-tab="visual-studio-code" tabindex="-1">Visual Studio Code</a>
</li>
<li role="presentation">
<a href="#tabpanel_CeZOj-G++Q-1_visual-studio-mac" role="tab" aria-controls="tabpanel_CeZOj-G++Q-1_visual-studio-mac" data-tab="visual-studio-mac" tabindex="-1">Visual Studio for Mac</a>
</li>
</ul>
<section id="tabpanel_CeZOj-G++Q-1_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li><p>右键单击“视图”文件夹，然后单击“添加”&gt;“新文件夹”，并将文件夹命名为“HelloWorld”。</p>
</li>
<li><p>右键单击“Views/HelloWorld”文件夹，然后单击“添加”&gt;“新项”。</p>
</li>
<li><p>在“添加新项 - MvcMovie”对话框中</p>
<ul>
<li><p>在右上角的搜索框中，输入“视图”</p>
</li>
<li><p>选择“Razor 视图”</p>
</li>
<li><p>保持“名称”框的值：Index.cshtml。</p>
</li>
<li><p>选择“添加”</p>
</li>
</ul>
</li>
</ul>
<p><img src="adding-view/_static/add_view.png" alt="“添加新项”对话框"></p>
</section>
<section id="tabpanel_CeZOj-G++Q-1_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<p>为 <code>HelloWorldController</code> 添加 <code>Index</code> 视图。</p>
<ul>
<li>添加一个名为“Views/HelloWorld”的新文件夹。</li>
<li>向 Views/HelloWorld 文件夹添加名为“Index.cshtml”的新文件。</li>
</ul>
</section>
<section id="tabpanel_CeZOj-G++Q-1_visual-studio-mac" role="tabpanel" data-tab="visual-studio-mac" aria-hidden="true" hidden="hidden">

<ul>
<li><p>右键单击“视图”文件夹，然后单击“添加”&gt;“新文件夹”，并将文件夹命名为“HelloWorld”。</p>
</li>
<li><p>右键单击“Views/HelloWorld”文件夹，然后单击“添加”&gt;“新文件”。</p>
</li>
<li><p>在“新建文件”对话框中：</p>
<ul>
<li>在左窗格中，选择“Web”。</li>
<li>在中间窗格中，选择“空 HTML 文件”。</li>
<li>在“名称”框中键入“Index.cshtml”。</li>
<li>选择“新建”。</li>
</ul>
</li>
</ul>
<p><img src="adding-view/_static/add_view_mac.png" alt="“添加新项”对话框"></p>
</section>
</div>

<p>使用以下内容替换 Razor 视图文件 Views/HelloWorld/Index.cshtml 的内容：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>导航到 <code>https://localhost:{PORT}/HelloWorld</code>。 <code>HelloWorldController</code> 中的 <code>Index</code> 方法作用不大；它运行 <code>return View();</code> 语句，指定此方法应使用视图模板文件来呈现对浏览器的响应。 由于未指定视图模板文件名称，MVC 默认使用默认视图文件。 默认视图文件具有与方法 (<code>Index</code>) 相同的名称，因此在 /Views/HelloWorld/Index.cshtml 中使用。 下面图片显示了视图中硬编码的 字符串“Hello from our View Template!”</p>
<p><img src="adding-view/_static/hell_template.png" alt="浏览器窗口"></p>
<h2 id="change-views-and-layout-pages">更改视图和布局页面</h2>
<p>选择菜单链接（“MvcMovie”、“首页”和“隐私”）  。 每页显示相同的菜单布局。 菜单布局是在 Views/Shared/_Layout.cshtml 文件中实现的。 打开 Views/Shared/_Layout.cshtml 文件。</p>
<p><a class="xref" href="../../mvc/views/layout.html">布局</a>模板使你能够在一个位置指定网站的 HTML 容器布局，然后将它应用到网站中的多个页面。 查找 <code>@RenderBody()</code> 行。 <code>RenderBody</code> 是显示创建的所有特定于视图的页面的占位符，已包装在布局页面中。 例如，如果选择“隐私”链接，Views/Home/Privacy.cshtml 视图将在 <code>RenderBody</code> 方法中呈现 。</p>
<h2 id="change-the-title-footer-and-menu-link-in-the-layout-file">更改布局文件中的标题、页脚和菜单链接</h2>
<ul>
<li>在标题和页脚元素中，将 <code>MvcMovie</code> 更改为 <code>Movie App</code>。</li>
<li>将定位点元素 <code>&lt;a class=&quot;navbar-brand&quot; asp-area=&quot;&quot; asp-controller=&quot;Home&quot; asp-action=&quot;Index&quot;&gt;MvcMovie&lt;/a&gt;</code> 更改为 <code>&lt;a class=&quot;navbar-brand&quot; asp-controller=&quot;Movies&quot; asp-action=&quot;Index&quot;&gt;Movie App&lt;/a&gt;</code>。</li>
</ul>
<p>下列标记显示了突出显示的更改：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>在前面的标记中，省略了 <code>asp-area</code> <a class="xref" href="../../mvc/views/tag-helpers/built-in/anchor-tag-helper.html">定位点标记帮助程序属性</a>，因为此应用未使用<a class="xref" href="../../mvc/controllers/areas.html">区域</a>。</p>
<!-- Routing has changed in 2.2, it's going to the last route.
>[!WARNING]
> We haven't implemented the `Movies` controller yet, so if you click the `Movie App` link, you get a 404 (Not found) error.
-->
<p><strong>说明</strong>：<code>Movies</code> 控制器尚未实现。 此时，<code>Movie App</code> 链接不起作用。</p>
<p>保存更改并选择“隐私”链接。 请注意浏览器选项卡上的标题现在显示的是“隐私策略 - 电影应用”，而不是“隐私策略 - Mvc 电影”：</p>
<p><img src="adding-view/_static/about2.png" alt="“隐私”选项卡"></p>
<p>选择“主页”链接，请注意，标题和定位文本还会显示“电影应用” 。 我们能够在布局模板中进行一次更改，让网站上的所有页面都反映新的链接文本和新标题。</p>
<p>检查 Views/_ViewStart.cshtml 文件：</p>
<pre><code class="lang-cshtml">@{
    Layout = &quot;_Layout&quot;;
}
</code></pre>
<p>Views/_ViewStart.cshtml 文件将 Views/Shared/_Layout.cshtml 文件引入到每个视图中 。 可以使用 <code>Layout</code> 属性设置不同的布局视图，或将它设置为 <code>null</code>，这样将不会使用任何布局文件。</p>
<p>更改 Views/HelloWorld/Index.cshtml 视图文件的 <code>&lt;h2&gt;</code> 元素：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>稍稍对标题和 <code>&lt;h2&gt;</code> 元素进行一些更改，这样可以看出哪一段代码更改了显示。</p>
<p>上述代码中的 <code>ViewData[&quot;Title&quot;] = &quot;Movie List&quot;;</code> 将 <code>ViewData</code> 字典的 <code>Title</code> 属性设置为“Movie List”。 <code>Title</code> 属性在布局页面中的 <code>&lt;title&gt;</code> HTML 元素中使用：</p>
<pre><code class="lang-cshtml">&lt;title&gt;@ViewData[&quot;Title&quot;] - Movie App&lt;/title&gt;
</code></pre>
<p>保存更改并导航到 <code>https://localhost:{PORT}/HelloWorld</code>。 请注意，浏览器标题、主标题和辅助标题已更改。 （如果没有在浏览器中看到更改，则可能正在查看缓存的内容。 在浏览器中按 Ctrl + F5 强制加载来自服务器的响应。）浏览器标题是使用我们在 Index.cshtml 视图模板中设置的 <code>ViewData[&quot;Title&quot;]</code> 以及在布局文件中添加的额外“ - Movie App”创建的。</p>
<p>还要注意，Index.cshtml 视图模板中的内容是如何与 Views/Shared/_Layout.cshtml 视图模板合并的，并且注意单个 HTML 响应被发送到了浏览器 。 凭借布局模板可以很容易地对应用程序中所有页面进行更改。 若要了解更多信息，请参阅<a class="xref" href="../../mvc/views/layout.html">布局</a>。</p>
<p><img src="adding-view/_static/hell3.png" alt="电影列表视图"></p>
<p>但我们这一点点“数据”（在此示例中为“Hello from our View Template!” 消息）是硬编码的。 MVC 应用程序有一个“V”（视图），而你已有一个“C”（控制器），但还没有“M”（模型）。</p>
<h2 id="passing-data-from-the-controller-to-the-view">将数据从控制器传递给视图</h2>
<p>控制器操作会被调用以响应传入的 URL 请求。 控制器类是编写处理传入浏览器请求的代码的地方。 控制器从数据源检索数据，并决定将哪些类型的响应发送回浏览器。 可以从控制器使用视图模板来生成并格式化对浏览器的 HTML 响应。</p>
<p>控制器负责提供所需的数据，使视图模板能够呈现响应。 最佳做法：视图模板不应该直接执行业务逻辑或与数据库进行交互。 相反，视图模板应仅使用由控制器提供给它的数据。 保持此“分离关注点”有助于保持代码干净以及可测试性和可维护性。</p>
<p>目前，<code>HelloWorldController</code> 类中的 <code>Welcome</code> 方法采用 <code>name</code> 和 <code>ID</code> 参数，然后将值直接输出到浏览器。 应将控制器更改为使用视图模板，而不是使控制器将此响应呈现为字符串。 视图模板会生成动态响应，这意味着必须将适当的数据位从控制器传递给视图以生成响应。 为此，可以让控制器将视图模板所需的动态数据（参数）放置在视图模板稍后可以访问的 <code>ViewData</code> 字典中。</p>
<p>在 HelloWorldController.cs 中，更改 <code>Welcome</code> 方法以将 <code>Message</code> 和 <code>NumTimes</code> 值添加到 <code>ViewData</code> 字典。 <code>ViewData</code> 字典是一个动态对象，这意味着可以使用任何类型；只有将内容放在其中后 <code>ViewData</code> 对象才具有定义的属性。 <a class="xref" href="../../mvc/models/model-binding.html">MVC 模型绑定系统</a>自动将命名参数（<code>name</code> 和 <code>numTimes</code>）从地址栏中的查询字符串映射到方法中的参数。 完整的 HelloWorldController.cs 文件如下所示：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p><code>ViewData</code> 字典对象包含将传递给视图的数据。</p>
<p>创建一个名为 Views/HelloWorld/Welcome.cshtml 的 Welcome 视图模板。</p>
<p>在 Welcome.cshtml 视图模板中创建一个循环，显示“Hello” <code>NumTimes</code>。 使用以下内容替换 Views/HelloWorld/Welcome.cshtml 的内容：</p>
<div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>保存更改并浏览到以下 URL：</p>
<p><code>https://localhost:{PORT}/HelloWorld/Welcome?name=Rick&amp;numtimes=4</code></p>
<p>数据取自 URL，并传递给使用 <a class="xref" href="../../mvc/models/model-binding.html">MVC 模型绑定器</a>的控制器。 控制器将数据打包到 <code>ViewData</code> 字典中，并将该对象传递给视图。 然后，视图将数据作为 HTML 呈现给浏览器。</p>
<p><img src="adding-view/_static/rick2.png" alt="“隐私”视图，显示了 Welcome 标签以及四个“Hello Rick”短语"></p>
<p>在上面的示例中，我们使用 <code>ViewData</code> 字典将数据从控制器传递给视图。 稍后在本教程中，我们将使用视图模型将数据从控制器传递给视图。 传递数据的视图模型方法通常比 <code>ViewData</code> 字典方法更为优先。 有关详细信息，请参阅<a href="https://www.rachelappel.com/when-to-use-viewbag-viewdata-or-tempdata-in-asp-net-mvc-3-applications/">何时使用 ViewBag、ViewData 或 TempData</a>。</p>
<p>在下一个教程中，将创建电影数据库。</p>
<div class="step-by-step">
<p><a href="adding-controller.html">上一页</a>
<a href="adding-model.html">下一页</a></p>
</div>
</div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
